import{a as U}from "./chunk-6ZGCKHA5.js";import{a as v,b as _,c as M,d as O}from "./chunk-OJSX3Q5S.js";import{Na as E,Ra as I,ga as b,s as S,w as T,x as C}from "./chunk-WBJK5ZQV.js";import{a as $,f as N}from "./chunk-GAL4ENT6.js";var B=N(U(),1);var q= e=>{throw TypeError(e)},P=(e, t, s)=>t.has(e)||q("Cannot "+s),a=(e, t, s)=>(P(e,t,"read from private field"),s?s.call(e):t.get(e)),n=(e, t, s)=>t.has(e)?q("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),h=(e, t, s, i)=>(P(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),D=(e, t, s)=>(P(e,t,"access private method"),s),w,u,k,r,m,c,y,W,H,j=class{constructor(t){n(this,W),n(this,w),n(this,u),n(this,k),n(this,r),n(this,m),n(this,c),n(this,y),h(this,m,!1),this.onShow=()=>{},this.onHide=()=>{},h(this,y,(s, i)=>{var o;let{state:l,composing:g}=s,{selection:d,doc:x}=l,{ranges:f}=d,K=Math.min(...f.map(p=>p.$from.pos)),L=Math.max(...f.map(p=>p.$to.pos)),R=i&&i.doc.eq(x)&&i.selection.eq(d);if(a(this,m)||((o=s.dom.parentElement)==null||o.appendChild(this.element),h(this,m,!0)),!(g||R)){if(!a(this,u).call(this,s,i)){this.hide();return}O({getBoundingClientRect:()=>b(s,K,L)},this.element,{placement:a(this,r).placement??"top",middleware:[M(),v(a(this,c)),_(),...a(this,k)]}).then(({x:p,y:F})=>{Object.assign(this.element.style,{left:`${p}px`,top:`${F}px`})}),this.show()}}),this.update=(s, i)=>{(0,B.default)(a(this,y),a(this,w))(s,i)},this.destroy=()=>{},this.show= s=>{this.element.dataset.show="true",s&&O(s,this.element,$({placement:"top",middleware:[M(),v(a(this,c))]},a(this,r))).then(({x:i,y:o})=>{Object.assign(this.element.style,{left:`${i}px`,top:`${o}px`})}),this.onShow()},this.hide=()=>{this.element.dataset.show!=="false"&&(this.element.dataset.show="false",this.onHide())},this.element=t.content,h(this,w,t.debounce??200),h(this,u,t.shouldShow??D(this,W,H)),h(this,c,t.offset),h(this,k,t.middleware??[]),h(this,r,t.floatingUIOptions??{}),this.element.dataset.show="false"}};w=new WeakMap,u=new WeakMap,k=new WeakMap,r=new WeakMap,m=new WeakMap,c=new WeakMap,y=new WeakMap,W=new WeakSet,H=function(e){let{doc:t,selection:s}=e.state,{empty:i,from:o,to:l}=s,g=!t.textBetween(o,l).length&&e.state.selection instanceof S,d=this.element.contains(document.activeElement),x=!e.hasFocus()&&!d,f=!e.editable;return!(x||i||g||f)};function Q(e){let t=I({},`${e}_TOOLTIP_SPEC`),s=E(o=>{let l=o.get(t.key);return new T($({key:new C(`${e}_TOOLTIP`)},l))}),i=[t,s];return i.key=t.key,i.pluginKey=s.key,t.meta={package:"@milkdown/plugin-tooltip",displayName:`Ctx<tooltipSpec>|${e}`},s.meta={package:"@milkdown/plugin-tooltip",displayName:`Prose<tooltip>|${e}`},i}export{j as a,Q as b};
