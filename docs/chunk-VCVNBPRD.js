import{a as Qt,l as en,v as tn}from "./chunk-GMRP4QB5.js";import{$ as xe,Aa as fe,C as ke,F as Ce,G as $t,H as Q,I as oe,J as ye,K as Bt,Ka as v,L as ee,La as Se,M as D,N as q,Na as de,O as ce,P as U,Q as O,R as Pe,S as jt,Sa as X,T as Wt,Ta as Jt,Ua as He,Wa as Yt,X as Kt,Xa as Zt,Z as Vt,a as L,aa as _e,b as _,ea as Gt,ha as ue,ka as qt,ma as Oe,p as _t,q as F,r as Ot,s as I,sa as Ut,t as Ht,ua as Xt,w as G,x as $,y as Y,z as Z}from "./chunk-WBJK5ZQV.js";import{a as y,b as S}from "./chunk-GAL4ENT6.js";var Be,je;if(typeof WeakMap<"u"){let e=new WeakMap;Be= t=>e.get(t),je=(t, n)=>(e.set(t,n),n)}else{let e=[],n=0;Be= o=>{for(let r=0; r<e.length; r+=2)if(e[r]==o)return e[r+1]},je=(o, r)=>(n==10&&(n=0),e[n++]=o,e[n++]=r)}var A=class{constructor(e, t, n, o){this.width=e,this.height=t,this.map=n,this.problems=o}findCell(e){for(let t=0; t<this.map.length; t++){let n=this.map[t];if(n!=e)continue;let o=t%this.width,r=t/this.width|0,i=o+1,l=r+1;for(let a=1; i<this.width&&this.map[t+a]==n; a++)i++;for(let a=1; l<this.height&&this.map[t+this.width*a]==n; a++)l++;return{left:o,top:r,right:i,bottom:l}}throw new RangeError(`No cell with offset ${e} found`)}colCount(e){for(let t=0; t<this.map.length; t++)if(this.map[t]==e)return t%this.width;throw new RangeError(`No cell with offset ${e} found`)}nextCell(e, t, n){let{left:o,right:r,top:i,bottom:l}=this.findCell(e);return t=="horiz"?(n<0?o==0:r==this.width)?null:this.map[i*this.width+(n<0?o-1:r)]:(n<0?i==0:l==this.height)?null:this.map[o+this.width*(n<0?i-1:l)]}rectBetween(e, t){let{left:n,right:o,top:r,bottom:i}=this.findCell(e),{left:l,right:a,top:s,bottom:c}=this.findCell(t);return{left:Math.min(n,l),top:Math.min(r,s),right:Math.max(o,a),bottom:Math.max(i,c)}}cellsInRect(e){let t=[],n={};for(let o=e.top; o<e.bottom; o++)for(let r=e.left; r<e.right; r++){let i=o*this.width+r,l=this.map[i];n[l]||(n[l]=!0,!(r==e.left&&r&&this.map[i-1]==l||o==e.top&&o&&this.map[i-this.width]==l)&&t.push(l))}return t}positionAt(e, t, n){for(let o=0,r=0;; o++){let i=r+n.child(o).nodeSize;if(o==e){let l=t+e*this.width,a=(e+1)*this.width;for(; l<a&&this.map[l]<r;)l++;return l==a?i-1:this.map[l]}r=i}}static get(e){return Be(e)||je(e,To(e))}};function To(e){if(e.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+e.type.name);let t=Mo(e),n=e.childCount,o=[],r=0,i=null,l=[];for(let c=0,f=t*n; c<f; c++)o[c]=0;for(let c=0,f=0; c<n; c++){let u=e.child(c);f++;for(let p=0;; p++){for(; r<o.length&&o[r]!=0;)r++;if(p==u.childCount)break;let b=u.child(p),{colspan:w,rowspan:g,colwidth:C}=b.attrs;for(let x=0; x<g; x++){if(x+c>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:f,n:g-x});break}let N=r+x*t;for(let M=0; M<w; M++){o[N+M]==0?o[N+M]=f:(i||(i=[])).push({type:"collision",row:c,pos:f,n:w-M});let R=C&&C[M];if(R){let H=(N+M)%t*2,V=l[H];V==null||V!=R&&l[H+1]==1?(l[H]=R,l[H+1]=1):V==R&&l[H+1]++}}}r+=w,f+=b.nodeSize}let d=(c+1)*t,h=0;for(; r<d;)o[r++]==0&&h++;h&&(i||(i=[])).push({type:"missing",row:c,n:h}),f++}let a=new A(t,n,o,i),s=!1;for(let c=0; !s&&c<l.length; c+=2)l[c]!=null&&l[c+1]<n&&(s=!0);return s&&Ro(a,l,e),a}function Mo(e){let t=-1,n=!1;for(let o=0; o<e.childCount; o++){let r=e.child(o),i=0;if(n)for(let l=0; l<o; l++){let a=e.child(l);for(let s=0; s<a.childCount; s++){let c=a.child(s);l+c.attrs.rowspan>o&&(i+=c.attrs.colspan)}}for(let l=0; l<r.childCount; l++){let a=r.child(l);i+=a.attrs.colspan,a.attrs.rowspan>1&&(n=!0)}t==-1?t=i:t!=i&&(t=Math.max(t,i))}return t}function Ro(e, t, n){e.problems||(e.problems=[]);let o={};for(let r=0; r<e.map.length; r++){let i=e.map[r];if(o[i])continue;o[i]=!0;let l=n.nodeAt(i);if(!l)throw new RangeError(`No cell with offset ${i} found`);let a=null,s=l.attrs;for(let c=0; c<s.colspan; c++){let f=(r+c)%e.width,u=t[f*2];u!=null&&(!s.colwidth||s.colwidth[c]!=u)&&((a||(a=No(s)))[c]=u)}a&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:a})}}function No(e){if(e.colwidth)return e.colwidth.slice();let t=[];for(let n=0; n<e.colspan; n++)t.push(0);return t}function nn(e, t){if(typeof e=="string")return{};let n=e.getAttribute("data-colwidth"),o=n&&/^\d+(,\d+)*$/.test(n)?n.split(",").map(l=>Number(l)):null,r=Number(e.getAttribute("colspan")||1),i={colspan:r,rowspan:Number(e.getAttribute("rowspan")||1),colwidth:o&&o.length==r?o:null};for(let l in t){let a=t[l].getFromDOM,s=a&&a(e);s!=null&&(i[l]=s)}return i}function on(e, t){let n={};e.attrs.colspan!=1&&(n.colspan=e.attrs.colspan),e.attrs.rowspan!=1&&(n.rowspan=e.attrs.rowspan),e.attrs.colwidth&&(n["data-colwidth"]=e.attrs.colwidth.join(","));for(let o in t){let r=t[o].setDOMAttr;r&&r(e.attrs[o],n)}return n}function pn(e){let t=e.cellAttributes||{},n={colspan:{default:1},rowspan:{default:1},colwidth:{default:null}};for(let o in t)n[o]={default:t[o].default};return{table:{content:"table_row+",tableRole:"table",isolating:!0,group:e.tableGroup,parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}},table_row:{content:"(table_cell | table_header)*",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}},table_cell:{content:e.cellContent,attrs:n,tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs: o=>nn(o,t)}],toDOM(o){return["td",on(o,t),0]}},table_header:{content:e.cellContent,attrs:n,tableRole:"header_cell",isolating:!0,parseDOM:[{tag:"th",getAttrs: o=>nn(o,t)}],toDOM(o){return["th",on(o,t),0]}}}}function P(e){let t=e.cached.tableNodeTypes;if(!t){t=e.cached.tableNodeTypes={};for(let n in e.nodes){let o=e.nodes[n],r=o.spec.tableRole;r&&(t[r]=o)}}return t}var J=new $("selectingCells");function pe(e){for(let t=e.depth-1; t>0; t--)if(e.node(t).type.spec.tableRole=="row")return e.node(0).resolve(e.before(t+1));return null}function E(e){let t=e.selection.$head;for(let n=t.depth; n>0; n--)if(t.node(n).type.spec.tableRole=="row")return!0;return!1}function De(e){let t=e.selection;if("$anchorCell"in t&&t.$anchorCell)return t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell;if("node"in t&&t.node&&t.node.type.spec.tableRole=="cell")return t.$anchor;let n=pe(t.$head)||Do(t.$head);if(n)return n;throw new RangeError(`No cell found around position ${t.head}`)}function Do(e){for(let t=e.nodeAfter,n=e.pos; t; t=t.firstChild,n++){let o=t.type.spec.tableRole;if(o=="cell"||o=="header_cell")return e.doc.resolve(n)}for(let t=e.nodeBefore,n=e.pos; t; t=t.lastChild,n--){let o=t.type.spec.tableRole;if(o=="cell"||o=="header_cell")return e.doc.resolve(n-t.nodeSize)}}function We(e){return e.parent.type.spec.tableRole=="row"&&!!e.nodeAfter}function vo(e){return e.node(0).resolve(e.pos+e.nodeAfter.nodeSize)}function Ge(e, t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function hn(e, t, n){let o=e.node(-1),r=A.get(o),i=e.start(-1),l=r.nextCell(e.pos-i,t,n);return l==null?null:e.node(0).resolve(i+l)}function te(e, t, n=1){let o=S(y({},e),{colspan:e.colspan-n});return o.colwidth&&(o.colwidth=o.colwidth.slice(),o.colwidth.splice(t,n),o.colwidth.some(r=>r>0)||(o.colwidth=null)),o}function Fo(e, t, n=1){let o=S(y({},e),{colspan:e.colspan+n});if(o.colwidth){o.colwidth=o.colwidth.slice();for(let r=0; r<n; r++)o.colwidth.splice(t,0,0)}return o}function Lo(e, t, n){let o=P(t.type.schema).header_cell;for(let r=0; r<e.height; r++)if(t.nodeAt(e.map[n+r*e.width]).type!=o)return!1;return!0}var T=class j extends F{constructor(t, n=t){let o=t.node(-1),r=A.get(o),i=t.start(-1),l=r.rectBetween(t.pos-i,n.pos-i),a=t.node(0),s=r.cellsInRect(l).filter(f=>f!=n.pos-i);s.unshift(n.pos-i);let c=s.map(f=>{let u=o.nodeAt(f);if(!u)throw RangeError(`No cell with offset ${f} found`);let d=i+f+1;return new Ot(a.resolve(d),a.resolve(d+u.content.size))});super(c[0].$from,c[0].$to,c),this.$anchorCell=t,this.$headCell=n}map(t, n){let o=t.resolve(n.map(this.$anchorCell.pos)),r=t.resolve(n.map(this.$headCell.pos));if(We(o)&&We(r)&&Ge(o,r)){let i=this.$anchorCell.node(-1)!=o.node(-1);return i&&this.isRowSelection()?j.rowSelection(o,r):i&&this.isColSelection()?j.colSelection(o,r):new j(o,r)}return I.between(o,r)}content(){let t=this.$anchorCell.node(-1),n=A.get(t),o=this.$anchorCell.start(-1),r=n.rectBetween(this.$anchorCell.pos-o,this.$headCell.pos-o),i={},l=[];for(let s=r.top; s<r.bottom; s++){let c=[];for(let f=s*n.width+r.left,u=r.left; u<r.right; u++,f++){let d=n.map[f];if(i[d])continue;i[d]=!0;let h=n.findCell(d),p=t.nodeAt(d);if(!p)throw RangeError(`No cell with offset ${d} found`);let b=r.left-h.left,w=h.right-r.right;if(b>0||w>0){let g=p.attrs;if(b>0&&(g=te(g,0,b)),w>0&&(g=te(g,g.colspan-w,w)),h.left<r.left){if(p=p.type.createAndFill(g),!p)throw RangeError(`Could not create cell with attrs ${JSON.stringify(g)}`)}else p=p.type.create(g,p.content)}if(h.top<r.top||h.bottom>r.bottom){let g=S(y({},p.attrs),{rowspan:Math.min(h.bottom,r.bottom)-Math.max(h.top,r.top)});h.top<r.top?p=p.type.createAndFill(g):p=p.type.create(g,p.content)}c.push(p)}l.push(t.child(s).copy(L.from(c)))}let a=this.isColSelection()&&this.isRowSelection()?t:l;return new _(L.from(a),1,1)}replace(t, n=_.empty){let o=t.steps.length,r=this.ranges;for(let l=0; l<r.length; l++){let{$from:a,$to:s}=r[l],c=t.mapping.slice(o);t.replace(c.map(a.pos),c.map(s.pos),l?_.empty:n)}let i=F.findFrom(t.doc.resolve(t.mapping.slice(o).map(this.to)),-1);i&&t.setSelection(i)}replaceWith(t, n){this.replace(t,new _(L.from(n),0,0))}forEachCell(t){let n=this.$anchorCell.node(-1),o=A.get(n),r=this.$anchorCell.start(-1),i=o.cellsInRect(o.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r));for(let l=0; l<i.length; l++)t(n.nodeAt(i[l]),r+i[l])}isColSelection(){let t=this.$anchorCell.index(-1),n=this.$headCell.index(-1);if(Math.min(t,n)>0)return!1;let o=t+this.$anchorCell.nodeAfter.attrs.rowspan,r=n+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(o,r)==this.$headCell.node(-1).childCount}static colSelection(t, n=t){let o=t.node(-1),r=A.get(o),i=t.start(-1),l=r.findCell(t.pos-i),a=r.findCell(n.pos-i),s=t.node(0);return l.top<=a.top?(l.top>0&&(t=s.resolve(i+r.map[l.left])),a.bottom<r.height&&(n=s.resolve(i+r.map[r.width*(r.height-1)+a.right-1]))):(a.top>0&&(n=s.resolve(i+r.map[a.left])),l.bottom<r.height&&(t=s.resolve(i+r.map[r.width*(r.height-1)+l.right-1]))),new j(t,n)}isRowSelection(){let t=this.$anchorCell.node(-1),n=A.get(t),o=this.$anchorCell.start(-1),r=n.colCount(this.$anchorCell.pos-o),i=n.colCount(this.$headCell.pos-o);if(Math.min(r,i)>0)return!1;let l=r+this.$anchorCell.nodeAfter.attrs.colspan,a=i+this.$headCell.nodeAfter.attrs.colspan;return Math.max(l,a)==n.width}eq(t){return t instanceof j&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t, n=t){let o=t.node(-1),r=A.get(o),i=t.start(-1),l=r.findCell(t.pos-i),a=r.findCell(n.pos-i),s=t.node(0);return l.left<=a.left?(l.left>0&&(t=s.resolve(i+r.map[l.top*r.width])),a.right<r.width&&(n=s.resolve(i+r.map[r.width*(a.top+1)-1]))):(a.left>0&&(n=s.resolve(i+r.map[a.top*r.width])),l.right<r.width&&(t=s.resolve(i+r.map[r.width*(l.top+1)-1]))),new j(t,n)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t, n){return new j(t.resolve(n.anchor),t.resolve(n.head))}static create(t, n, o=n){return new j(t.resolve(n),t.resolve(o))}getBookmark(){return new zo(this.$anchorCell.pos,this.$headCell.pos)}};T.prototype.visible=!1;F.jsonID("cell",T);var zo=class mn{constructor(t, n){this.anchor=t,this.head=n}map(t){return new mn(t.map(this.anchor),t.map(this.head))}resolve(t){let n=t.resolve(this.anchor),o=t.resolve(this.head);return n.parent.type.spec.tableRole=="row"&&o.parent.type.spec.tableRole=="row"&&n.index()<n.parent.childCount&&o.index()<o.parent.childCount&&Ge(n,o)?new T(n,o):F.near(o,1)}};function Eo(e){if(!(e.selection instanceof T))return null;let t=[];return e.selection.forEachCell((n, o)=>{t.push(Y.node(o,o+n.nodeSize,{class:"selectedCell"}))}),Z.create(e.doc,t)}function Io({$from:e,$to:t}){if(e.pos==t.pos||e.pos<t.pos-6)return!1;let n=e.pos,o=t.pos,r=e.depth;for(; r>=0&&!(e.after(r+1)<e.end(r)); r--,n++);for(let i=t.depth; i>=0&&!(t.before(i+1)>t.start(i)); i--,o--);return n==o&&/row|table/.test(e.node(r).type.spec.tableRole)}function Po({$from:e,$to:t}){let n,o;for(let r=e.depth; r>0; r--){let i=e.node(r);if(i.type.spec.tableRole==="cell"||i.type.spec.tableRole==="header_cell"){n=i;break}}for(let r=t.depth; r>0; r--){let i=t.node(r);if(i.type.spec.tableRole==="cell"||i.type.spec.tableRole==="header_cell"){o=i;break}}return n!==o&&t.parentOffset===0}function _o(e, t, n){let o=(t||e).selection,r=(t||e).doc,i,l;if(o instanceof Ht&&(l=o.node.type.spec.tableRole)){if(l=="cell"||l=="header_cell")i=T.create(r,o.from);else if(l=="row"){let a=r.resolve(o.from+1);i=T.rowSelection(a,a)}else if(!n){let a=A.get(o.node),s=o.from+1,c=s+a.map[a.width*a.height-1];i=T.create(r,s+1,c)}}else o instanceof I&&Io(o)?i=I.create(r,o.from):o instanceof I&&Po(o)&&(i=I.create(r,o.$from.start(),o.$from.end()));return i&&(t||(t=e.tr)).setSelection(i),t}var Oo=new $("fix-tables");function gn(e, t, n, o){let r=e.childCount,i=t.childCount;e:for(let l=0,a=0; l<i; l++){let s=t.child(l);for(let c=a,f=Math.min(r,l+3); c<f; c++)if(e.child(c)==s){a=c+1,n+=s.nodeSize;continue e}o(s,n),a<r&&e.child(a).sameMarkup(s)?gn(e.child(a),s,n+1,o):s.nodesBetween(0,s.content.size,o,n+1),n+=s.nodeSize}}function Ho(e, t){let n,o=(r, i)=>{r.type.spec.tableRole=="table"&&(n=$o(e,r,i,n))};return t?t.doc!=e.doc&&gn(t.doc,e.doc,0,o):e.doc.descendants(o),n}function $o(e, t, n, o){let r=A.get(t);if(!r.problems)return o;o||(o=e.tr);let i=[];for(let s=0; s<r.height; s++)i.push(0);for(let s=0; s<r.problems.length; s++){let c=r.problems[s];if(c.type=="collision"){let f=t.nodeAt(c.pos);if(!f)continue;let u=f.attrs;for(let d=0; d<u.rowspan; d++)i[c.row+d]+=c.n;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,te(u,u.colspan-c.n,c.n))}else if(c.type=="missing")i[c.row]+=c.n;else if(c.type=="overlong_rowspan"){let f=t.nodeAt(c.pos);if(!f)continue;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,S(y({},f.attrs),{rowspan:f.attrs.rowspan-c.n}))}else if(c.type=="colwidth mismatch"){let f=t.nodeAt(c.pos);if(!f)continue;o.setNodeMarkup(o.mapping.map(n+1+c.pos),null,S(y({},f.attrs),{colwidth:c.colwidth}))}}let l,a;for(let s=0; s<i.length; s++)i[s]&&(l==null&&(l=s),a=s);for(let s=0,c=n+1; s<r.height; s++){let f=t.child(s),u=c+f.nodeSize,d=i[s];if(d>0){let h="cell";f.firstChild&&(h=f.firstChild.type.spec.tableRole);let p=[];for(let w=0; w<d; w++){let g=P(e.schema)[h].createAndFill();g&&p.push(g)}let b=(s==0||l==s-1)&&a==s?c+1:u-1;o.insert(o.mapping.map(b),p)}c=u}return o.setMeta(Oo,{fixTables:!0})}function W(e){let t=e.selection,n=De(e),o=n.node(-1),r=n.start(-1),i=A.get(o),l=t instanceof T?i.rectBetween(t.$anchorCell.pos-r,t.$headCell.pos-r):i.findCell(n.pos-r);return S(y({},l),{tableStart:r,map:i,table:o})}function bn(e, {map:t,tableStart:n,table:o}, r){let i=r>0?-1:0;Lo(t,o,r+i)&&(i=r==0||r==t.width?null:0);for(let l=0; l<t.height; l++){let a=l*t.width+r;if(r>0&&r<t.width&&t.map[a-1]==t.map[a]){let s=t.map[a],c=o.nodeAt(s);e.setNodeMarkup(e.mapping.map(n+s),null,Fo(c.attrs,r-t.colCount(s))),l+=c.attrs.rowspan-1}else{let s=i==null?P(o.type.schema).cell:o.nodeAt(t.map[a+i]).type,c=t.positionAt(l,r,o);e.insert(e.mapping.map(n+c),s.createAndFill())}}return e}function wn(e, t){if(!E(e))return!1;if(t){let n=W(e);t(bn(e.tr,n,n.left))}return!0}function kn(e, t){if(!E(e))return!1;if(t){let n=W(e);t(bn(e.tr,n,n.right))}return!0}function Bo(e, {map:t,table:n,tableStart:o}, r){let i=e.mapping.maps.length;for(let l=0; l<t.height;){let a=l*t.width+r,s=t.map[a],c=n.nodeAt(s),f=c.attrs;if(r>0&&t.map[a-1]==s||r<t.width-1&&t.map[a+1]==s)e.setNodeMarkup(e.mapping.slice(i).map(o+s),null,te(f,r-t.colCount(s)));else{let u=e.mapping.slice(i).map(o+s);e.delete(u,u+c.nodeSize)}l+=f.rowspan}}function Cn(e, t){if(!E(e))return!1;if(t){let n=W(e),o=e.tr;if(n.left==0&&n.right==n.map.width)return!1;for(let r=n.right-1; Bo(o,n,r),r!=n.left; r--){let i=n.tableStart?o.doc.nodeAt(n.tableStart-1):o.doc;if(!i)throw RangeError("No table found");n.table=i,n.map=A.get(i)}t(o)}return!0}function jo(e, {map:t,table:n,tableStart:o}, r){let i=0;for(let c=0; c<r; c++)i+=n.child(c).nodeSize;let l=i+n.child(r).nodeSize,a=e.mapping.maps.length;e.delete(i+o,l+o);let s=new Set;for(let c=0,f=r*t.width; c<t.width; c++,f++){let u=t.map[f];if(!s.has(u)){if(s.add(u),r>0&&u==t.map[f-t.width]){let d=n.nodeAt(u).attrs;e.setNodeMarkup(e.mapping.slice(a).map(u+o),null,S(y({},d),{rowspan:d.rowspan-1})),c+=d.colspan-1}else if(r<t.height&&u==t.map[f+t.width]){let d=n.nodeAt(u),h=d.attrs,p=d.type.create(S(y({},h),{rowspan:d.attrs.rowspan-1}),d.content),b=t.positionAt(r+1,c,n);e.insert(e.mapping.slice(a).map(o+b),p),c+=h.colspan-1}}}}function yn(e, t){if(!E(e))return!1;if(t){let n=W(e),o=e.tr;if(n.top==0&&n.bottom==n.map.height)return!1;for(let r=n.bottom-1; jo(o,n,r),r!=n.top; r--){let i=n.tableStart?o.doc.nodeAt(n.tableStart-1):o.doc;if(!i)throw RangeError("No table found");n.table=i,n.map=A.get(n.table)}t(o)}return!0}function xn(e, t){return function(n, o){if(!E(n))return!1;let r=De(n);if(r.nodeAfter.attrs[e]===t)return!1;if(o){let i=n.tr;n.selection instanceof T?n.selection.forEachCell((l, a)=>{l.attrs[e]!==t&&i.setNodeMarkup(a,null,S(y({},l.attrs),{[e]:t}))}):i.setNodeMarkup(r.pos,null,S(y({},r.nodeAfter.attrs),{[e]:t})),o(i)}return!0}}function Wo(e){return function(t, n){if(!E(t))return!1;if(n){let o=P(t.schema),r=W(t),i=t.tr,l=r.map.cellsInRect(e=="column"?{left:r.left,top:0,right:r.right,bottom:r.map.height}:e=="row"?{left:0,top:r.top,right:r.map.width,bottom:r.bottom}:r),a=l.map(s=>r.table.nodeAt(s));for(let s=0; s<l.length; s++)a[s].type==o.header_cell&&i.setNodeMarkup(r.tableStart+l[s],o.cell,a[s].attrs);if(i.steps.length==0)for(let s=0; s<l.length; s++)i.setNodeMarkup(r.tableStart+l[s],o.header_cell,a[s].attrs);n(i)}return!0}}function rn(e, t, n){let o=t.map.cellsInRect({left:0,top:0,right:e=="row"?t.map.width:1,bottom:e=="column"?t.map.height:1});for(let r=0; r<o.length; r++){let i=t.table.nodeAt(o[r]);if(i&&i.type!==n.header_cell)return!1}return!0}function qe(e, t){return t=t||{useDeprecatedLogic:!1},t.useDeprecatedLogic?Wo(e):function(n, o){if(!E(n))return!1;if(o){let r=P(n.schema),i=W(n),l=n.tr,a=rn("row",i,r),s=rn("column",i,r),f=(e==="column"?a:e==="row"?s:!1)?1:0,u=e=="column"?{left:0,top:f,right:1,bottom:i.map.height}:e=="row"?{left:f,top:0,right:i.map.width,bottom:1}:i,d=e=="column"?s?r.cell:r.header_cell:e=="row"?a?r.cell:r.header_cell:r.cell;i.map.cellsInRect(u).forEach(h=>{let p=h+i.tableStart,b=l.doc.nodeAt(p);b&&l.setNodeMarkup(p,d,b.attrs)}),o(l)}return!0}}var Ql=qe("row",{useDeprecatedLogic:!0}),ei=qe("column",{useDeprecatedLogic:!0}),ti=qe("cell",{useDeprecatedLogic:!0});function Ko(e, t){if(t<0){let n=e.nodeBefore;if(n)return e.pos-n.nodeSize;for(let o=e.index(-1)-1,r=e.before(); o>=0; o--){let i=e.node(-1).child(o),l=i.lastChild;if(l)return r-1-l.nodeSize;r-=i.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;let n=e.node(-1);for(let o=e.indexAfter(-1),r=e.after(); o<n.childCount; o++){let i=n.child(o);if(i.childCount)return r+1;r+=i.nodeSize}}return null}function Ue(e){return function(t, n){if(!E(t))return!1;let o=Ko(De(t),e);if(o==null)return!1;if(n){let r=t.doc.resolve(o);n(t.tr.setSelection(I.between(r,vo(r))).scrollIntoView())}return!0}}function Sn(e, t){let n=e.selection.$anchor;for(let o=n.depth; o>0; o--)if(n.node(o).type.spec.tableRole=="table")return t&&t(e.tr.delete(n.before(o),n.after(o)).scrollIntoView()),!0;return!1}function Ae(e, t){let n=e.selection;if(!(n instanceof T))return!1;if(t){let o=e.tr,r=P(e.schema).cell.createAndFill().content;n.forEachCell((i, l)=>{i.content.eq(r)||o.replace(o.mapping.map(l+1),o.mapping.map(l+i.nodeSize-1),new _(r,0,0))}),o.docChanged&&t(o)}return!0}function Vo(e){if(!e.size)return null;let{content:t,openStart:n,openEnd:o}=e;for(; t.childCount==1&&(n>0&&o>0||t.child(0).type.spec.tableRole=="table");)n--,o--,t=t.child(0).content;let r=t.child(0),i=r.type.spec.tableRole,l=r.type.schema,a=[];if(i=="row")for(let s=0; s<t.childCount; s++){let c=t.child(s).content,f=s?0:Math.max(0,n-1),u=s<t.childCount-1?0:Math.max(0,o-1);(f||u)&&(c=Ke(P(l).row,new _(c,f,u)).content),a.push(c)}else if(i=="cell"||i=="header_cell")a.push(n||o?Ke(P(l).row,new _(t,n,o)).content:t);else return null;return Go(l,a)}function Go(e, t){let n=[];for(let r=0; r<t.length; r++){let i=t[r];for(let l=i.childCount-1; l>=0; l--){let{rowspan:a,colspan:s}=i.child(l).attrs;for(let c=r; c<r+a; c++)n[c]=(n[c]||0)+s}}let o=0;for(let r=0; r<n.length; r++)o=Math.max(o,n[r]);for(let r=0; r<n.length; r++)if(r>=t.length&&t.push(L.empty),n[r]<o){let i=P(e).cell.createAndFill(),l=[];for(let a=n[r]; a<o; a++)l.push(i);t[r]=t[r].append(L.from(l))}return{height:t.length,width:o,rows:t}}function Ke(e, t){let n=e.createAndFill();return new _t(n).replace(0,n.content.size,t).doc}function qo({width:e,height:t,rows:n}, o, r){if(e!=o){let i=[],l=[];for(let a=0; a<n.length; a++){let s=n[a],c=[];for(let f=i[a]||0,u=0; f<o; u++){let d=s.child(u%s.childCount);f+d.attrs.colspan>o&&(d=d.type.createChecked(te(d.attrs,d.attrs.colspan,f+d.attrs.colspan-o),d.content)),c.push(d),f+=d.attrs.colspan;for(let h=1; h<d.attrs.rowspan; h++)i[a+h]=(i[a+h]||0)+d.attrs.colspan}l.push(L.from(c))}n=l,e=o}if(t!=r){let i=[];for(let l=0,a=0; l<r; l++,a++){let s=[],c=n[a%t];for(let f=0; f<c.childCount; f++){let u=c.child(f);l+u.attrs.rowspan>r&&(u=u.type.create(S(y({},u.attrs),{rowspan:Math.max(1,r-u.attrs.rowspan)}),u.content)),s.push(u)}i.push(L.from(s))}n=i,t=r}return{width:e,height:t,rows:n}}function Uo(e, t, n, o, r, i, l){let a=e.doc.type.schema,s=P(a),c,f;if(r>t.width)for(let u=0,d=0; u<t.height; u++){let h=n.child(u);d+=h.nodeSize;let p=[],b;h.lastChild==null||h.lastChild.type==s.cell?b=c||(c=s.cell.createAndFill()):b=f||(f=s.header_cell.createAndFill());for(let w=t.width; w<r; w++)p.push(b);e.insert(e.mapping.slice(l).map(d-1+o),p)}if(i>t.height){let u=[];for(let p=0,b=(t.height-1)*t.width; p<Math.max(t.width,r); p++){let w=p>=t.width?!1:n.nodeAt(t.map[b+p]).type==s.header_cell;u.push(w?f||(f=s.header_cell.createAndFill()):c||(c=s.cell.createAndFill()))}let d=s.row.create(null,L.from(u)),h=[];for(let p=t.height; p<i; p++)h.push(d);e.insert(e.mapping.slice(l).map(o+n.nodeSize-2),h)}return!!(c||f)}function ln(e, t, n, o, r, i, l, a){if(l==0||l==t.height)return!1;let s=!1;for(let c=r; c<i; c++){let f=l*t.width+c,u=t.map[f];if(t.map[f-t.width]==u){s=!0;let d=n.nodeAt(u),{top:h,left:p}=t.findCell(u);e.setNodeMarkup(e.mapping.slice(a).map(u+o),null,S(y({},d.attrs),{rowspan:l-h})),e.insert(e.mapping.slice(a).map(t.positionAt(l,p,n)),d.type.createAndFill(S(y({},d.attrs),{rowspan:h+d.attrs.rowspan-l}))),c+=d.attrs.colspan-1}}return s}function an(e, t, n, o, r, i, l, a){if(l==0||l==t.width)return!1;let s=!1;for(let c=r; c<i; c++){let f=c*t.width+l,u=t.map[f];if(t.map[f-1]==u){s=!0;let d=n.nodeAt(u),h=t.colCount(u),p=e.mapping.slice(a).map(u+o);e.setNodeMarkup(p,null,te(d.attrs,l-h,d.attrs.colspan-(l-h))),e.insert(p+d.nodeSize,d.type.createAndFill(te(d.attrs,0,l-h))),c+=d.attrs.rowspan-1}}return s}function sn(e, t, n, o, r){let i=n?e.doc.nodeAt(n-1):e.doc;if(!i)throw new Error("No table found");let l=A.get(i),{top:a,left:s}=o,c=s+r.width,f=a+r.height,u=e.tr,d=0;function h(){if(i=n?u.doc.nodeAt(n-1):u.doc,!i)throw new Error("No table found");l=A.get(i),d=u.mapping.maps.length}Uo(u,l,i,n,c,f,d)&&h(),ln(u,l,i,n,s,c,a,d)&&h(),ln(u,l,i,n,s,c,f,d)&&h(),an(u,l,i,n,a,f,s,d)&&h(),an(u,l,i,n,a,f,c,d)&&h();for(let p=a; p<f; p++){let b=l.positionAt(p,s,i),w=l.positionAt(p,c,i);u.replace(u.mapping.slice(d).map(b+n),u.mapping.slice(d).map(w+n),new _(r.rows[p-a],0,0))}h(),u.setSelection(new T(u.doc.resolve(n+l.positionAt(a,s,i)),u.doc.resolve(n+l.positionAt(f-1,c-1,i)))),t(u)}var Xo=Xt({ArrowLeft:Te("horiz",-1),ArrowRight:Te("horiz",1),ArrowUp:Te("vert",-1),ArrowDown:Te("vert",1),"Shift-ArrowLeft":Me("horiz",-1),"Shift-ArrowRight":Me("horiz",1),"Shift-ArrowUp":Me("vert",-1),"Shift-ArrowDown":Me("vert",1),Backspace:Ae,"Mod-Backspace":Ae,Delete:Ae,"Mod-Delete":Ae});function Re(e, t, n){return n.eq(e.selection)?!1:(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function Te(e, t){return(n, o, r)=>{if(!r)return!1;let i=n.selection;if(i instanceof T)return Re(n,o,F.near(i.$headCell,t));if(e!="horiz"&&!i.empty)return!1;let l=An(r,e,t);if(l==null)return!1;if(e=="horiz")return Re(n,o,F.near(n.doc.resolve(i.head+t),t));{let a=n.doc.resolve(l),s=hn(a,e,t),c;return s?c=F.near(s,1):t<0?c=F.near(n.doc.resolve(a.before(-1)),-1):c=F.near(n.doc.resolve(a.after(-1)),1),Re(n,o,c)}}}function Me(e, t){return(n, o, r)=>{if(!r)return!1;let i=n.selection,l;if(i instanceof T)l=i;else{let s=An(r,e,t);if(s==null)return!1;l=new T(n.doc.resolve(s))}let a=hn(l.$headCell,e,t);return a?Re(n,o,new T(l.$anchorCell,a)):!1}}function Jo(e, t){let n=e.state.doc,o=pe(n.resolve(t));return o?(e.dispatch(e.state.tr.setSelection(new T(o))),!0):!1}function Yo(e, t, n){if(!E(e.state))return!1;let o=Vo(n),r=e.state.selection;if(r instanceof T){o||(o={width:1,height:1,rows:[L.from(Ke(P(e.state.schema).cell,n))]});let i=r.$anchorCell.node(-1),l=r.$anchorCell.start(-1),a=A.get(i).rectBetween(r.$anchorCell.pos-l,r.$headCell.pos-l);return o=qo(o,a.right-a.left,a.bottom-a.top),sn(e.state,e.dispatch,l,a,o),!0}else if(o){let i=De(e.state),l=i.start(-1);return sn(e.state,e.dispatch,l,A.get(i.node(-1)).findCell(i.pos-l),o),!0}else return!1}function Zo(e, t){var n;if(t.ctrlKey||t.metaKey)return;let o=cn(e,t.target),r;if(t.shiftKey&&e.state.selection instanceof T)i(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&o&&(r=pe(e.state.selection.$anchor))!=null&&((n=$e(e,t))==null?void 0:n.pos)!=r.pos)i(r,t),t.preventDefault();else if(!o)return;function i(s, c){let f=$e(e,c),u=J.getState(e.state)==null;if(!f||!Ge(s,f))if(u)f=s;else return;let d=new T(s,f);if(u||!e.state.selection.eq(d)){let h=e.state.tr.setSelection(d);u&&h.setMeta(J,s.pos),e.dispatch(h)}}function l(){e.root.removeEventListener("mouseup",l),e.root.removeEventListener("dragstart",l),e.root.removeEventListener("mousemove",a),J.getState(e.state)!=null&&e.dispatch(e.state.tr.setMeta(J,-1))}function a(s){let c=s,f=J.getState(e.state),u;if(f!=null)u=e.state.doc.resolve(f);else if(cn(e,c.target)!=o&&(u=$e(e,t),!u))return l();u&&i(u,c)}e.root.addEventListener("mouseup",l),e.root.addEventListener("dragstart",l),e.root.addEventListener("mousemove",a)}function An(e, t, n){if(!(e.state.selection instanceof I))return null;let{$head:o}=e.state.selection;for(let r=o.depth-1; r>=0; r--){let i=o.node(r);if((n<0?o.index(r):o.indexAfter(r))!=(n<0?0:i.childCount))return null;if(i.type.spec.tableRole=="cell"||i.type.spec.tableRole=="header_cell"){let a=o.before(r),s=t=="vert"?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(s)?a:null}}return null}function cn(e, t){for(; t&&t!=e.dom; t=t.parentNode)if(t.nodeName=="TD"||t.nodeName=="TH")return t;return null}function $e(e, t){let n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?pe(e.state.doc.resolve(n.pos)):null}var Qo=class{constructor(e, t){this.node=e,this.defaultCellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.table.style.setProperty("--default-cell-min-width",`${t}px`),this.colgroup=this.table.appendChild(document.createElement("colgroup")),Ve(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type!=this.node.type?!1:(this.node=e,Ve(e,this.colgroup,this.table,this.defaultCellMinWidth),!0)}ignoreMutation(e){return e.type=="attributes"&&(e.target==this.table||this.colgroup.contains(e.target))}};function Ve(e, t, n, o, r, i){var l;let a=0,s=!0,c=t.firstChild,f=e.firstChild;if(f){for(let u=0,d=0; u<f.childCount; u++){let{colspan:h,colwidth:p}=f.child(u).attrs;for(let b=0; b<h; b++,d++){let w=r==d?i:p&&p[b],g=w?w+"px":"";if(a+=w||o,w||(s=!1),c)c.style.width!=g&&(c.style.width=g),c=c.nextSibling;else{let C=document.createElement("col");C.style.width=g,t.appendChild(C)}}}for(; c;){let u=c.nextSibling;(l=c.parentNode)==null||l.removeChild(c),c=u}s?(n.style.width=a+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=a+"px")}}var z=new $("tableColumnResizing");function Tn({handleWidth:e=5,cellMinWidth:t=25,defaultCellMinWidth:n=100,View:o=Qo,lastColumnResizable:r=!0}={}){let i=new G({key:z,state:{init(l, a){var s,c;let f=(c=(s=i.spec)==null?void 0:s.props)==null?void 0:c.nodeViews,u=P(a.schema).table.name;return o&&f&&(f[u]=(d, h)=>new o(d,n,h)),new er(-1,!1)},apply(l, a){return a.apply(l)}},props:{attributes: l=>{let a=z.getState(l);return a&&a.activeHandle>-1?{class:"resize-cursor"}:{}},handleDOMEvents:{mousemove:(l, a)=>{tr(l,a,e,r)},mouseleave: l=>{nr(l)},mousedown:(l, a)=>{or(l,a,t,n)}},decorations: l=>{let a=z.getState(l);if(a&&a.activeHandle>-1)return sr(l,a.activeHandle)},nodeViews:{}}});return i}var er=class Ne{constructor(t, n){this.activeHandle=t,this.dragging=n}apply(t){let n=this,o=t.getMeta(z);if(o&&o.setHandle!=null)return new Ne(o.setHandle,!1);if(o&&o.setDragging!==void 0)return new Ne(n.activeHandle,o.setDragging);if(n.activeHandle>-1&&t.docChanged){let r=t.mapping.map(n.activeHandle,-1);return We(t.doc.resolve(r))||(r=-1),new Ne(r,n.dragging)}return n}};function tr(e, t, n, o){if(!e.editable)return;let r=z.getState(e.state);if(r&&!r.dragging){let i=lr(t.target),l=-1;if(i){let{left:a,right:s}=i.getBoundingClientRect();t.clientX-a<=n?l=un(e,t,"left",n):s-t.clientX<=n&&(l=un(e,t,"right",n))}if(l!=r.activeHandle){if(!o&&l!==-1){let a=e.state.doc.resolve(l),s=a.node(-1),c=A.get(s),f=a.start(-1);if(c.colCount(a.pos-f)+a.nodeAfter.attrs.colspan-1==c.width-1)return}Mn(e,l)}}}function nr(e){if(!e.editable)return;let t=z.getState(e.state);t&&t.activeHandle>-1&&!t.dragging&&Mn(e,-1)}function or(e, t, n, o){var r;if(!e.editable)return!1;let i=(r=e.dom.ownerDocument.defaultView)!=null?r:window,l=z.getState(e.state);if(!l||l.activeHandle==-1||l.dragging)return!1;let a=e.state.doc.nodeAt(l.activeHandle),s=rr(e,l.activeHandle,a.attrs);e.dispatch(e.state.tr.setMeta(z,{setDragging:{startX:t.clientX,startWidth:s}}));function c(u){i.removeEventListener("mouseup",c),i.removeEventListener("mousemove",f);let d=z.getState(e.state);d?.dragging&&(ir(e,d.activeHandle,fn(d.dragging,u,n)),e.dispatch(e.state.tr.setMeta(z,{setDragging:null})))}function f(u){if(!u.which)return c(u);let d=z.getState(e.state);if(d&&d.dragging){let h=fn(d.dragging,u,n);dn(e,d.activeHandle,h,o)}}return dn(e,l.activeHandle,s,o),i.addEventListener("mouseup",c),i.addEventListener("mousemove",f),t.preventDefault(),!0}function rr(e, t, {colspan:n,colwidth:o}){let r=o&&o[o.length-1];if(r)return r;let i=e.domAtPos(t),a=i.node.childNodes[i.offset].offsetWidth,s=n;if(o)for(let c=0; c<n; c++)o[c]&&(a-=o[c],s--);return a/s}function lr(e){for(; e&&e.nodeName!="TD"&&e.nodeName!="TH";)e=e.classList&&e.classList.contains("ProseMirror")?null:e.parentNode;return e}function un(e, t, n, o){let r=n=="right"?-o:o,i=e.posAtCoords({left:t.clientX+r,top:t.clientY});if(!i)return-1;let{pos:l}=i,a=pe(e.state.doc.resolve(l));if(!a)return-1;if(n=="right")return a.pos;let s=A.get(a.node(-1)),c=a.start(-1),f=s.map.indexOf(a.pos-c);return f%s.width==0?-1:c+s.map[f-1]}function fn(e, t, n){let o=t.clientX-e.startX;return Math.max(n,e.startWidth+o)}function Mn(e, t){e.dispatch(e.state.tr.setMeta(z,{setHandle:t}))}function ir(e, t, n){let o=e.state.doc.resolve(t),r=o.node(-1),i=A.get(r),l=o.start(-1),a=i.colCount(o.pos-l)+o.nodeAfter.attrs.colspan-1,s=e.state.tr;for(let c=0; c<i.height; c++){let f=c*i.width+a;if(c&&i.map[f]==i.map[f-i.width])continue;let u=i.map[f],d=r.nodeAt(u).attrs,h=d.colspan==1?0:a-i.colCount(u);if(d.colwidth&&d.colwidth[h]==n)continue;let p=d.colwidth?d.colwidth.slice():ar(d.colspan);p[h]=n,s.setNodeMarkup(l+u,null,S(y({},d),{colwidth:p}))}s.docChanged&&e.dispatch(s)}function dn(e, t, n, o){let r=e.state.doc.resolve(t),i=r.node(-1),l=r.start(-1),a=A.get(i).colCount(r.pos-l)+r.nodeAfter.attrs.colspan-1,s=e.domAtPos(r.start(-1)).node;for(; s&&s.nodeName!="TABLE";)s=s.parentNode;s&&Ve(i,s.firstChild,s,o,a,n)}function ar(e){return Array(e).fill(0)}function sr(e, t){var n;let o=[],r=e.doc.resolve(t),i=r.node(-1);if(!i)return Z.empty;let l=A.get(i),a=r.start(-1),s=l.colCount(r.pos-a)+r.nodeAfter.attrs.colspan-1;for(let c=0; c<l.height; c++){let f=s+c*l.width;if((s==l.width-1||l.map[f]!=l.map[f+1])&&(c==0||l.map[f]!=l.map[f-l.width])){let u=l.map[f],d=a+u+i.nodeAt(u).nodeSize-1,h=document.createElement("div");h.className="column-resize-handle",(n=z.getState(e))!=null&&n.dragging&&o.push(Y.node(a+u,a+u+i.nodeAt(u).nodeSize,{class:"column-resize-dragging"})),o.push(Y.widget(d,h))}}return Z.create(e.doc,o)}function Rn({allowTableNodeSelection:e=!1}={}){return new G({key:J,state:{init(){return null},apply(t, n){let o=t.getMeta(J);if(o!=null)return o==-1?null:o;if(n==null||!t.docChanged)return n;let{deleted:r,pos:i}=t.mapping.mapResult(n);return r?null:i}},props:{decorations:Eo,handleDOMEvents:{mousedown:Zo},createSelectionBetween(t){return J.getState(t.state)!=null?t.state.selection:null},handleTripleClick:Jo,handleKeyDown:Xo,handlePaste:Yo},appendTransaction(t, n, o){return _o(o,Ho(o,n),e)}})}var ve=typeof navigator<"u"?navigator:null,Je=ve&&ve.userAgent||"",cr=/Edge\/(\d+)/.exec(Je),ur=/MSIE \d/.exec(Je),fr=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Je),dr=!!(ur||fr||cr),pr=!dr&&!!ve&&/Apple Computer/.test(ve.vendor),Nn=new $("safari-ime-span"),Xe=!1,hr={key:Nn,props:{decorations:mr,handleDOMEvents:{compositionstart:()=>{Xe=!0},compositionend:()=>{Xe=!1}}}};function mr(e){let{$from:t,$to:n,to:o}=e.selection;if(Xe&&t.sameParent(n)){let r=Y.widget(o,gr,{ignoreSelection:!0,key:"safari-ime-span"});return Z.create(e.doc,[r])}}function gr(e){let t=e.dom.ownerDocument.createElement("span");return t.className="ProseMirror-safari-ime-span",t}var Dn=new G(pr?hr:{key:Nn});function Ye(e, t){let n=String(e);if(typeof t!="string")throw new TypeError("Expected character");let o=0,r=n.indexOf(t);for(; r!==-1;)o++,r=n.indexOf(t,r+t.length);return o}function Ze(e, t, n){let r=Kt((n||{}).ignore||[]),i=br(t),l=-1;for(; ++l<i.length;)Vt(e,"text",a);function a(c, f){let u=-1,d;for(; ++u<f.length;){let h=f[u],p=d?d.children:void 0;if(r(h,p?p.indexOf(h):void 0,d))return;d=h}if(d)return s(c,f)}function s(c, f){let u=f[f.length-1],d=i[l][0],h=i[l][1],p=0,w=u.children.indexOf(c),g=!1,C=[];d.lastIndex=0;let x=d.exec(c.value);for(; x;){let N=x.index,M={index:x.index,input:x.input,stack:[...f,c]},R=h(...x,M);if(typeof R=="string"&&(R=R.length>0?{type:"text",value:R}:void 0),R===!1?d.lastIndex=N+1:(p!==N&&C.push({type:"text",value:c.value.slice(p,N)}),Array.isArray(R)?C.push(...R):R&&C.push(R),p=N+x[0].length,g=!0),!d.global)break;x=d.exec(c.value)}return g?(p<c.value.length&&C.push({type:"text",value:c.value.slice(p)}),u.children.splice(w,1,...C)):C=[c],w+C.length}}function br(e){let t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");let n=!e[0]||Array.isArray(e[0])?e:[e],o=-1;for(; ++o<n.length;){let r=n[o];t.push([wr(r[0]),kr(r[1])])}return t}function wr(e){return typeof e=="string"?new RegExp(Qt(e),"g"):e}function kr(e){return typeof e=="function"?e:function(){return e}}var Qe="phrasing",et=["autolink","link","image","label"];function nt(){return{transforms:[Tr],enter:{literalAutolink:Cr,literalAutolinkEmail:tt,literalAutolinkHttp:tt,literalAutolinkWww:tt},exit:{literalAutolink:Ar,literalAutolinkEmail:Sr,literalAutolinkHttp:yr,literalAutolinkWww:xr}}}function ot(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:Qe,notInConstruct:et},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:Qe,notInConstruct:et},{character:":",before:"[ps]",after:"\\/",inConstruct:Qe,notInConstruct:et}]}}function Cr(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function tt(e){this.config.enter.autolinkProtocol.call(this,e)}function yr(e){this.config.exit.autolinkProtocol.call(this,e)}function xr(e){this.config.exit.data.call(this,e);let t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function Sr(e){this.config.exit.autolinkEmail.call(this,e)}function Ar(e){this.exit(e)}function Tr(e){Ze(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,Mr],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),Rr]],{ignore:["link","linkReference"]})}function Mr(e, t, n, o, r){let i="";if(!vn(r)||(/^w/i.test(t)&&(n=t+n,t="",i="http://"),!Nr(n)))return!1;let l=Dr(n+o);if(!l[0])return!1;let a={type:"link",title:null,url:i+t+l[0],children:[{type:"text",value:t+l[0]}]};return l[1]?[a,{type:"text",value:l[1]}]:a}function Rr(e, t, n, o){return!vn(o,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function Nr(e){let t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function Dr(e){let t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],o=n.indexOf(")"),r=Ye(e,"("),i=Ye(e,")");for(; o!==-1&&r>i;)e+=n.slice(0,o+1),n=n.slice(o+1),o=n.indexOf(")"),i++;return[e,n]}function vn(e, t){let n=e.input.charCodeAt(e.index-1);return(e.index===0||U(n)||ce(n))&&(!t||n!==47)}Fn.peek=Or;function rt(){return{enter:{gfmFootnoteDefinition:vr,gfmFootnoteDefinitionLabelString:Fr,gfmFootnoteCall:Er,gfmFootnoteCallString:Ir},exit:{gfmFootnoteDefinition:zr,gfmFootnoteDefinitionLabelString:Lr,gfmFootnoteCall:_r,gfmFootnoteCallString:Pr}}}function lt(){return{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:Hr,footnoteReference:Fn}}}function vr(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function Fr(){this.buffer()}function Lr(e){let t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.label=t,n.identifier=Q(this.sliceSerialize(e)).toLowerCase()}function zr(e){this.exit(e)}function Er(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function Ir(){this.buffer()}function Pr(e){let t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.label=t,n.identifier=Q(this.sliceSerialize(e)).toLowerCase()}function _r(e){this.exit(e)}function Fn(e, t, n, o){let r=n.createTracker(o),i=r.move("[^"),l=n.enter("footnoteReference"),a=n.enter("reference");return i+=r.move(n.safe(n.associationId(e),S(y({},r.current()),{before:i,after:"]"}))),a(),l(),i+=r.move("]"),i}function Or(){return"["}function Hr(e, t, n, o){let r=n.createTracker(o),i=r.move("[^"),l=n.enter("footnoteDefinition"),a=n.enter("label");return i+=r.move(n.safe(n.associationId(e),S(y({},r.current()),{before:i,after:"]"}))),a(),i+=r.move("]:"+(e.children&&e.children.length>0?" ":"")),r.shift(4),i+=r.move(n.indentLines(n.containerFlow(e,r.current()),$r)),l(),i}function $r(e, t, n){return t===0?e:(n?"":"    ")+e}var Br=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];Ln.peek=Kr;function it(){return{canContainEols:["delete"],enter:{strikethrough:jr},exit:{strikethrough:Wr}}}function at(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:Br}],handlers:{delete:Ln}}}function jr(e){this.enter({type:"delete",children:[]},e)}function Wr(e){this.exit(e)}function Ln(e, t, n, o){let r=n.createTracker(o),i=n.enter("strikethrough"),l=r.move("~~");return l+=n.containerPhrasing(e,S(y({},r.current()),{before:l,after:"~"})),l+=r.move("~~"),i(),l}function Kr(){return"~"}function Vr(e){return e.length}function En(e, t){let n=t||{},o=(n.align||[]).concat(),r=n.stringLength||Vr,i=[],l=[],a=[],s=[],c=0,f=-1;for(; ++f<e.length;){let b=[],w=[],g=-1;for(e[f].length>c&&(c=e[f].length); ++g<e[f].length;){let C=Gr(e[f][g]);if(n.alignDelimiters!==!1){let x=r(C);w[g]=x,(s[g]===void 0||x>s[g])&&(s[g]=x)}b.push(C)}l[f]=b,a[f]=w}let u=-1;if(typeof o=="object"&&"length"in o)for(; ++u<c;)i[u]=zn(o[u]);else{let b=zn(o);for(; ++u<c;)i[u]=b}u=-1;let d=[],h=[];for(; ++u<c;){let b=i[u],w="",g="";b===99?(w=":",g=":"):b===108?w=":":b===114&&(g=":");let C=n.alignDelimiters===!1?1:Math.max(1,s[u]-w.length-g.length),x=w+"-".repeat(C)+g;n.alignDelimiters!==!1&&(C=w.length+C+g.length,C>s[u]&&(s[u]=C),h[u]=C),d[u]=x}l.splice(1,0,d),a.splice(1,0,h),f=-1;let p=[];for(; ++f<l.length;){let b=l[f],w=a[f];u=-1;let g=[];for(; ++u<c;){let C=b[u]||"",x="",N="";if(n.alignDelimiters!==!1){let M=s[u]-(w[u]||0),R=i[u];R===114?x=" ".repeat(M):R===99?M%2?(x=" ".repeat(M/2+.5),N=" ".repeat(M/2-.5)):(x=" ".repeat(M/2),N=x):N=" ".repeat(M)}n.delimiterStart!==!1&&!u&&g.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&C==="")&&(n.delimiterStart!==!1||u)&&g.push(" "),n.alignDelimiters!==!1&&g.push(x),g.push(C),n.alignDelimiters!==!1&&g.push(N),n.padding!==!1&&g.push(" "),(n.delimiterEnd!==!1||u!==c-1)&&g.push("|")}p.push(n.delimiterEnd===!1?g.join("").replace(/ +$/,""):g.join(""))}return p.join(`
`)}function Gr(e){return e==null?"":String(e)}function zn(e){let t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function ct(){return{enter:{table:qr,tableData:In,tableHeader:In,tableRow:Xr},exit:{codeText:Jr,table:Ur,tableData:st,tableHeader:st,tableRow:st}}}function qr(e){let t=e._align;this.enter({type:"table",align:t.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function Ur(e){this.exit(e),this.data.inTable=void 0}function Xr(e){this.enter({type:"tableRow",children:[]},e)}function st(e){this.exit(e)}function In(e){this.enter({type:"tableCell",children:[]},e)}function Jr(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,Yr));let n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function Yr(e,t){return t==="|"?t:e}function ut(e){let t=e||{},n=t.tableCellPadding,o=t.tablePipeAlign,r=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:d,table:l,tableCell:s,tableRow:a}};function l(h,p,b,w){return c(f(h,b,w),h.align)}function a(h,p,b,w){let g=u(h,b,w),C=c([g]);return C.slice(0,C.indexOf(`
`))}function s(h,p,b,w){let g=b.enter("tableCell"),C=b.enter("phrasing"),x=b.containerPhrasing(h,S(y({},w),{before:i,after:i}));return C(),g(),x}function c(h,p){return En(h,{align:p,alignDelimiters:o,padding:n,stringLength:r})}function f(h,p,b){let w=h.children,g=-1,C=[],x=p.enter("table");for(;++g<w.length;)C[g]=u(w[g],p,b);return x(),C}function u(h,p,b){let w=h.children,g=-1,C=[],x=p.enter("tableRow");for(;++g<w.length;)C[g]=s(w[g],h,p,b);return x(),C}function d(h,p,b){let w=xe.inlineCode(h,p,b);return b.stack.includes("tableCell")&&(w=w.replace(/\|/g,"\\$&")),w}}function ft(){return{exit:{taskListCheckValueChecked:Pn,taskListCheckValueUnchecked:Pn,paragraph:Zr}}}function dt(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Qr}}}function Pn(e){let t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function Zr(e){let t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){let n=this.stack[this.stack.length-1];n.type;let o=n.children[0];if(o&&o.type==="text"){let r=t.children,i=-1,l;for(;++i<r.length;){let a=r[i];if(a.type==="paragraph"){l=a;break}}l===n&&(o.value=o.value.slice(1),o.value.length===0?n.children.shift():n.position&&o.position&&typeof o.position.start.offset=="number"&&(o.position.start.column++,o.position.start.offset++,n.position.start=Object.assign({},o.position.start)))}}this.exit(e)}function Qr(e,t,n,o){let r=e.children[0],i=typeof e.checked=="boolean"&&r&&r.type==="paragraph",l="["+(e.checked?"x":" ")+"] ",a=n.createTracker(o);i&&a.move(l);let s=xe.listItem(e,t,n,y(y({},o),a.current()));return i&&(s=s.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),s;function c(f){return f+l}}function pt(){return[nt(),rt(),it(),ct(),ft()]}function ht(e){return{extensions:[ot(),lt(),at(),ut(e),dt()]}}var el={tokenize:ll,partial:!0},_n={tokenize:il,partial:!0},On={tokenize:al,partial:!0},Hn={tokenize:sl,partial:!0},tl={tokenize:cl,partial:!0},$n={name:"wwwAutolink",tokenize:ol,previous:jn},Bn={name:"protocolAutolink",tokenize:rl,previous:Wn},K={name:"emailAutolink",tokenize:nl,previous:Kn},B={};function gt(){return{text:B}}var ne=48;for(;ne<123;)B[ne]=K,ne++,ne===58?ne=65:ne===91&&(ne=97);B[43]=K;B[45]=K;B[46]=K;B[95]=K;B[72]=[K,Bn];B[104]=[K,Bn];B[87]=[K,$n];B[119]=[K,$n];function nl(e,t,n){let o=this,r,i;return l;function l(u){return!mt(u)||!Kn.call(o,o.previous)||bt(o.events)?n(u):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),a(u))}function a(u){return mt(u)?(e.consume(u),a):u===64?(e.consume(u),s):n(u)}function s(u){return u===46?e.check(tl,f,c)(u):u===45||u===95||ye(u)?(i=!0,e.consume(u),s):f(u)}function c(u){return e.consume(u),r=!0,s}function f(u){return i&&r&&oe(o.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(u)):n(u)}}function ol(e,t,n){let o=this;return r;function r(l){return l!==87&&l!==119||!jn.call(o,o.previous)||bt(o.events)?n(l):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(el,e.attempt(_n,e.attempt(On,i),n),n)(l))}function i(l){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(l)}}function rl(e,t,n){let o=this,r="",i=!1;return l;function l(u){return(u===72||u===104)&&Wn.call(o,o.previous)&&!bt(o.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),r+=String.fromCodePoint(u),e.consume(u),a):n(u)}function a(u){if(oe(u)&&r.length<5)return r+=String.fromCodePoint(u),e.consume(u),a;if(u===58){let d=r.toLowerCase();if(d==="http"||d==="https")return e.consume(u),s}return n(u)}function s(u){return u===47?(e.consume(u),i?c:(i=!0,s)):n(u)}function c(u){return u===null||Bt(u)||D(u)||U(u)||ce(u)?n(u):e.attempt(_n,e.attempt(On,f),n)(u)}function f(u){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(u)}}function ll(e,t,n){let o=0;return r;function r(l){return(l===87||l===119)&&o<3?(o++,e.consume(l),r):l===46&&o===3?(e.consume(l),i):n(l)}function i(l){return l===null?n(l):t(l)}}function il(e,t,n){let o,r,i;return l;function l(c){return c===46||c===95?e.check(Hn,s,a)(c):c===null||D(c)||U(c)||c!==45&&ce(c)?s(c):(i=!0,e.consume(c),l)}function a(c){return c===95?o=!0:(r=o,o=void 0),e.consume(c),l}function s(c){return r||o||!i?n(c):t(c)}}function al(e,t){let n=0,o=0;return r;function r(l){return l===40?(n++,e.consume(l),r):l===41&&o<n?i(l):l===33||l===34||l===38||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===60||l===63||l===93||l===95||l===126?e.check(Hn,t,i)(l):l===null||D(l)||U(l)?t(l):(e.consume(l),r)}function i(l){return l===41&&o++,e.consume(l),r}}function sl(e,t,n){return o;function o(a){return a===33||a===34||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===63||a===95||a===126?(e.consume(a),o):a===38?(e.consume(a),i):a===93?(e.consume(a),r):a===60||a===null||D(a)||U(a)?t(a):n(a)}function r(a){return a===null||a===40||a===91||D(a)||U(a)?t(a):o(a)}function i(a){return oe(a)?l(a):n(a)}function l(a){return a===59?(e.consume(a),o):oe(a)?(e.consume(a),l):n(a)}}function cl(e,t,n){return o;function o(i){return e.consume(i),r}function r(i){return ye(i)?n(i):t(i)}}function jn(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||D(e)}function Wn(e){return!oe(e)}function Kn(e){return!(e===47||mt(e))}function mt(e){return e===43||e===45||e===46||e===95||ye(e)}function bt(e){let t=e.length,n=!1;for(;t--;){let o=e[t][1];if((o.type==="labelLink"||o.type==="labelImage")&&!o._balanced){n=!0;break}if(o._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}var ul={tokenize:bl,partial:!0};function wt(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:hl,continuation:{tokenize:ml},exit:gl}},text:{91:{name:"gfmFootnoteCall",tokenize:pl},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:fl,resolveTo:dl}}}}function fl(e,t,n){let o=this,r=o.events.length,i=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]),l;for(;r--;){let s=o.events[r][1];if(s.type==="labelImage"){l=s;break}if(s.type==="gfmFootnoteCall"||s.type==="labelLink"||s.type==="label"||s.type==="image"||s.type==="link")break}return a;function a(s){if(!l||!l._balanced)return n(s);let c=Q(o.sliceSerialize({start:l.end,end:o.now()}));return c.codePointAt(0)!==94||!i.includes(c.slice(1))?n(s):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(s),e.exit("gfmFootnoteCallLabelMarker"),t(s))}}function dl(e,t){let n=e.length,o;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){o=e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";let r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},i={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};i.end.column++,i.end.offset++,i.end._bufferIndex++;let l={type:"gfmFootnoteCallString",start:Object.assign({},i.end),end:Object.assign({},e[e.length-1][1].start)},a={type:"chunkString",contentType:"string",start:Object.assign({},l.start),end:Object.assign({},l.end)},s=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",i,t],["exit",i,t],["enter",l,t],["enter",a,t],["exit",a,t],["exit",l,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...s),e}function pl(e,t,n){let o=this,r=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]),i=0,l;return a;function a(u){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),s}function s(u){return u!==94?n(u):(e.enter("gfmFootnoteCallMarker"),e.consume(u),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",c)}function c(u){if(i>999||u===93&&!l||u===null||u===91||D(u))return n(u);if(u===93){e.exit("chunkString");let d=e.exit("gfmFootnoteCallString");return r.includes(Q(o.sliceSerialize(d)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(u),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(u)}return D(u)||(l=!0),i++,e.consume(u),u===92?f:c}function f(u){return u===91||u===92||u===93?(e.consume(u),i++,c):c(u)}}function hl(e,t,n){let o=this,r=o.parser.gfmFootnotes||(o.parser.gfmFootnotes=[]),i,l=0,a;return s;function s(p){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(p){return p===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",f):n(p)}function f(p){if(l>999||p===93&&!a||p===null||p===91||D(p))return n(p);if(p===93){e.exit("chunkString");let b=e.exit("gfmFootnoteDefinitionLabelString");return i=Q(o.sliceSerialize(b)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(p),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),d}return D(p)||(a=!0),l++,e.consume(p),p===92?u:f}function u(p){return p===91||p===92||p===93?(e.consume(p),l++,f):f(p)}function d(p){return p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),r.includes(i)||r.push(i),O(e,h,"gfmFootnoteDefinitionWhitespace")):n(p)}function h(p){return t(p)}}function ml(e,t,n){return e.check(Wt,t,e.attempt(ul,t,n))}function gl(e){e.exit("gfmFootnoteDefinition")}function bl(e,t,n){let o=this;return O(e,r,"gfmFootnoteDefinitionIndent",5);function r(i){let l=o.events[o.events.length-1];return l&&l[1].type==="gfmFootnoteDefinitionIndent"&&l[2].sliceSerialize(l[1],!0).length===4?t(i):n(i)}}function kt(e){let n=(e||{}).singleTilde,o={name:"strikethrough",tokenize:i,resolveAll:r};return n==null&&(n=!0),{text:{126:o},insideSpan:{null:[o]},attentionMarkers:{null:[126]}};function r(l,a){let s=-1;for(;++s<l.length;)if(l[s][0]==="enter"&&l[s][1].type==="strikethroughSequenceTemporary"&&l[s][1]._close){let c=s;for(;c--;)if(l[c][0]==="exit"&&l[c][1].type==="strikethroughSequenceTemporary"&&l[c][1]._open&&l[s][1].end.offset-l[s][1].start.offset===l[c][1].end.offset-l[c][1].start.offset){l[s][1].type="strikethroughSequence",l[c][1].type="strikethroughSequence";let f={type:"strikethrough",start:Object.assign({},l[c][1].start),end:Object.assign({},l[s][1].end)},u={type:"strikethroughText",start:Object.assign({},l[c][1].end),end:Object.assign({},l[s][1].start)},d=[["enter",f,a],["enter",l[c][1],a],["exit",l[c][1],a],["enter",u,a]],h=a.parser.constructs.insideSpan.null;h&&Ce(d,d.length,0,jt(h,l.slice(c+1,s),a)),Ce(d,d.length,0,[["exit",u,a],["enter",l[s][1],a],["exit",l[s][1],a],["exit",f,a]]),Ce(l,c-1,s-c+3,d),s=c+d.length-2;break}}for(s=-1;++s<l.length;)l[s][1].type==="strikethroughSequenceTemporary"&&(l[s][1].type="data");return l}function i(l,a,s){let c=this.previous,f=this.events,u=0;return d;function d(p){return c===126&&f[f.length-1][1].type!=="characterEscape"?s(p):(l.enter("strikethroughSequenceTemporary"),h(p))}function h(p){let b=Pe(c);if(p===126)return u>1?s(p):(l.consume(p),u++,h);if(u<2&&!n)return s(p);let w=l.exit("strikethroughSequenceTemporary"),g=Pe(p);return w._open=!g||g===2&&!!b,w._close=!b||b===2&&!!g,a(p)}}}var Fe=class{constructor(){this.map=[]}add(t,n,o){wl(this,t,n,o)}consume(t){if(this.map.sort(function(i,l){return i[0]-l[0]}),this.map.length===0)return;let n=this.map.length,o=[];for(;n>0;)n-=1,o.push(t.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),t.length=this.map[n][0];o.push(t.slice()),t.length=0;let r=o.pop();for(;r;){for(let i of r)t.push(i);r=o.pop()}this.map.length=0}};function wl(e,t,n,o){let r=0;if(!(n===0&&o.length===0)){for(;r<e.map.length;){if(e.map[r][0]===t){e.map[r][1]+=n,e.map[r][2].push(...o);return}r+=1}e.map.push([t,n,o])}}function Vn(e,t){let n=!1,o=[];for(;t<e.length;){let r=e[t];if(n){if(r[0]==="enter")r[1].type==="tableContent"&&o.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){let i=o.length-1;o[i]=o[i]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return o}function Ct(){return{flow:{null:{name:"table",tokenize:kl,resolveAll:Cl}}}}function kl(e,t,n){let o=this,r=0,i=0,l;return a;function a(m){let se=o.events.length-1;for(;se>-1;){let Pt=o.events[se][1].type;if(Pt==="lineEnding"||Pt==="linePrefix")se--;else break}let Et=se>-1?o.events[se][1].type:null,It=Et==="tableHead"||Et==="tableRow"?R:s;return It===R&&o.parser.lazy[o.now().line]?n(m):It(m)}function s(m){return e.enter("tableHead"),e.enter("tableRow"),c(m)}function c(m){return m===124||(l=!0,i+=1),f(m)}function f(m){return m===null?n(m):ee(m)?i>1?(i=0,o.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),h):n(m):q(m)?O(e,f,"whitespace")(m):(i+=1,l&&(l=!1,r+=1),m===124?(e.enter("tableCellDivider"),e.consume(m),e.exit("tableCellDivider"),l=!0,f):(e.enter("data"),u(m)))}function u(m){return m===null||m===124||D(m)?(e.exit("data"),f(m)):(e.consume(m),m===92?d:u)}function d(m){return m===92||m===124?(e.consume(m),u):u(m)}function h(m){return o.interrupt=!1,o.parser.lazy[o.now().line]?n(m):(e.enter("tableDelimiterRow"),l=!1,q(m)?O(e,p,"linePrefix",o.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(m):p(m))}function p(m){return m===45||m===58?w(m):m===124?(l=!0,e.enter("tableCellDivider"),e.consume(m),e.exit("tableCellDivider"),b):M(m)}function b(m){return q(m)?O(e,w,"whitespace")(m):w(m)}function w(m){return m===58?(i+=1,l=!0,e.enter("tableDelimiterMarker"),e.consume(m),e.exit("tableDelimiterMarker"),g):m===45?(i+=1,g(m)):m===null||ee(m)?N(m):M(m)}function g(m){return m===45?(e.enter("tableDelimiterFiller"),C(m)):M(m)}function C(m){return m===45?(e.consume(m),C):m===58?(l=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(m),e.exit("tableDelimiterMarker"),x):(e.exit("tableDelimiterFiller"),x(m))}function x(m){return q(m)?O(e,N,"whitespace")(m):N(m)}function N(m){return m===124?p(m):m===null||ee(m)?!l||r!==i?M(m):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(m)):M(m)}function M(m){return n(m)}function R(m){return e.enter("tableRow"),H(m)}function H(m){return m===124?(e.enter("tableCellDivider"),e.consume(m),e.exit("tableCellDivider"),H):m===null||ee(m)?(e.exit("tableRow"),t(m)):q(m)?O(e,H,"whitespace")(m):(e.enter("data"),V(m))}function V(m){return m===null||m===124||D(m)?(e.exit("data"),H(m)):(e.consume(m),m===92?Ao:V)}function Ao(m){return m===92||m===124?(e.consume(m),V):V(m)}}function Cl(e,t){let n=-1,o=!0,r=0,i=[0,0,0,0],l=[0,0,0,0],a=!1,s=0,c,f,u,d=new Fe;for(;++n<e.length;){let h=e[n],p=h[1];h[0]==="enter"?p.type==="tableHead"?(a=!1,s!==0&&(Gn(d,t,s,c,f),f=void 0,s=0),c={type:"table",start:Object.assign({},p.start),end:Object.assign({},p.end)},d.add(n,0,[["enter",c,t]])):p.type==="tableRow"||p.type==="tableDelimiterRow"?(o=!0,u=void 0,i=[0,0,0,0],l=[0,n+1,0,0],a&&(a=!1,f={type:"tableBody",start:Object.assign({},p.start),end:Object.assign({},p.end)},d.add(n,0,[["enter",f,t]])),r=p.type==="tableDelimiterRow"?2:f?3:1):r&&(p.type==="data"||p.type==="tableDelimiterMarker"||p.type==="tableDelimiterFiller")?(o=!1,l[2]===0&&(i[1]!==0&&(l[0]=l[1],u=Le(d,t,i,r,void 0,u),i=[0,0,0,0]),l[2]=n)):p.type==="tableCellDivider"&&(o?o=!1:(i[1]!==0&&(l[0]=l[1],u=Le(d,t,i,r,void 0,u)),i=l,l=[i[1],n,0,0])):p.type==="tableHead"?(a=!0,s=n):p.type==="tableRow"||p.type==="tableDelimiterRow"?(s=n,i[1]!==0?(l[0]=l[1],u=Le(d,t,i,r,n,u)):l[1]!==0&&(u=Le(d,t,l,r,n,u)),r=0):r&&(p.type==="data"||p.type==="tableDelimiterMarker"||p.type==="tableDelimiterFiller")&&(l[3]=n)}for(s!==0&&Gn(d,t,s,c,f),d.consume(t.events),n=-1;++n<t.events.length;){let h=t.events[n];h[0]==="enter"&&h[1].type==="table"&&(h[1]._align=Vn(t.events,n))}return e}function Le(e,t,n,o,r,i){let l=o===1?"tableHeader":o===2?"tableDelimiter":"tableData",a="tableContent";n[0]!==0&&(i.end=Object.assign({},re(t.events,n[0])),e.add(n[0],0,[["exit",i,t]]));let s=re(t.events,n[1]);if(i={type:l,start:Object.assign({},s),end:Object.assign({},s)},e.add(n[1],0,[["enter",i,t]]),n[2]!==0){let c=re(t.events,n[2]),f=re(t.events,n[3]),u={type:a,start:Object.assign({},c),end:Object.assign({},f)};if(e.add(n[2],0,[["enter",u,t]]),o!==2){let d=t.events[n[2]],h=t.events[n[3]];if(d[1].end=Object.assign({},h[1].end),d[1].type="chunkText",d[1].contentType="text",n[3]>n[2]+1){let p=n[2]+1,b=n[3]-n[2]-1;e.add(p,b,[])}}e.add(n[3]+1,0,[["exit",u,t]])}return r!==void 0&&(i.end=Object.assign({},re(t.events,r)),e.add(r,0,[["exit",i,t]]),i=void 0),i}function Gn(e,t,n,o,r){let i=[],l=re(t.events,n);r&&(r.end=Object.assign({},l),i.push(["exit",r,t])),o.end=Object.assign({},l),i.push(["exit",o,t]),e.add(n+1,0,i)}function re(e,t){let n=e[t],o=n[0]==="enter"?"start":"end";return n[1][o]}var yl={name:"tasklistCheck",tokenize:xl};function yt(){return{text:{91:yl}}}function xl(e,t,n){let o=this;return r;function r(s){return o.previous!==null||!o._gfmTasklistFirstContentOfListItem?n(s):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(s),e.exit("taskListCheckMarker"),i)}function i(s){return D(s)?(e.enter("taskListCheckValueUnchecked"),e.consume(s),e.exit("taskListCheckValueUnchecked"),l):s===88||s===120?(e.enter("taskListCheckValueChecked"),e.consume(s),e.exit("taskListCheckValueChecked"),l):n(s)}function l(s){return s===93?(e.enter("taskListCheckMarker"),e.consume(s),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),a):n(s)}function a(s){return ee(s)?t(s):q(s)?e.check({tokenize:Sl},t,n)(s):n(s)}}function Sl(e,t,n){return O(e,o,"whitespace");function o(r){return r===null?n(r):t(r)}}function qn(e){return $t([gt(),wt(),kt(e),Ct(),yt()])}var Al={};function ze(e){let t=this,n=e||Al,o=t.data(),r=o.micromarkExtensions||(o.micromarkExtensions=[]),i=o.fromMarkdownExtensions||(o.fromMarkdownExtensions=[]),l=o.toMarkdownExtensions||(o.toMarkdownExtensions=[]);r.push(qn(n)),i.push(pt()),l.push(ht(n))}function k(e,t){return Object.assign(e,{meta:y({package:"@milkdown/preset-gfm"},t)}),e}var At=Yt("strike_through");k(At,{displayName:"Attr<strikethrough>",group:"Strikethrough"});var he=Jt("strike_through",e=>({parseDOM:[{tag:"del"},{style:"text-decoration",getAttrs:t=>t==="line-through"}],toDOM:t=>["del",e.get(At.key)(t)],parseMarkdown:{match:t=>t.type==="delete",runner:(t,n,o)=>{t.openMark(o),t.next(n.children),t.closeMark(o)}},toMarkdown:{match:t=>t.type.name==="strike_through",runner:(t,n)=>{t.withMark(n,"delete")}}}));k(he.mark,{displayName:"MarkSchema<strikethrough>",group:"Strikethrough"});k(he.ctx,{displayName:"MarkSchemaCtx<strikethrough>",group:"Strikethrough"});var Tt=v("ToggleStrikeThrough",e=>()=>Ut(he.type(e)));k(Tt,{displayName:"Command<ToggleStrikethrough>",group:"Strikethrough"});var Zn=Se(e=>Gt(/~([^~]+)~$/,he.type(e)));k(Zn,{displayName:"InputRule<strikethrough>",group:"Strikethrough"});var Mt=He("strikeThroughKeymap",{ToggleStrikethrough:{shortcuts:"Mod-Alt-x",command:e=>{let t=e.get(fe);return()=>t.call(Tt.key)}}});k(Mt.ctx,{displayName:"KeymapCtx<strikethrough>",group:"Strikethrough"});k(Mt.shortcuts,{displayName:"Keymap<strikethrough>",group:"Strikethrough"});var me=pn({tableGroup:"block",cellContent:"paragraph",cellAttributes:{alignment:{default:"left",getFromDOM:e=>e.style.textAlign||"left",setDOMAttr:(e,t)=>{t.style=`text-align: ${e||"left"}`}}}}),ae=X("table",()=>S(y({},me.table),{content:"table_header_row table_row+",disableDropCursor:!0,parseMarkdown:{match:e=>e.type==="table",runner:(e,t,n)=>{let o=t.align,r=t.children.map((i,l)=>S(y({},i),{align:o,isHeader:l===0}));e.openNode(n),e.next(r),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="table",runner:(e,t)=>{var n;let o=(n=t.content.firstChild)==null?void 0:n.content;if(!o)return;let r=[];o.forEach(i=>{r.push(i.attrs.alignment)}),e.openNode("table",void 0,{align:r}),e.next(t.content),e.closeNode()}}}));k(ae.node,{displayName:"NodeSchema<table>",group:"Table"});k(ae.ctx,{displayName:"NodeSchemaCtx<table>",group:"Table"});var Ee=X("table_header_row",()=>S(y({},me.table_row),{disableDropCursor:!0,content:"(table_header)*",parseDOM:[{tag:"tr[data-is-header]"}],toDOM(){return["tr",{"data-is-header":!0},0]},parseMarkdown:{match:e=>!!(e.type==="tableRow"&&e.isHeader),runner:(e,t,n)=>{let o=t.align,r=t.children.map((i,l)=>S(y({},i),{align:o[l],isHeader:t.isHeader}));e.openNode(n),e.next(r),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="table_header_row",runner:(e,t)=>{e.openNode("tableRow",void 0,{isHeader:!0}),e.next(t.content),e.closeNode()}}}));k(Ee.node,{displayName:"NodeSchema<tableHeaderRow>",group:"Table"});k(Ee.ctx,{displayName:"NodeSchemaCtx<tableHeaderRow>",group:"Table"});var ge=X("table_row",()=>S(y({},me.table_row),{disableDropCursor:!0,content:"(table_cell)*",parseMarkdown:{match:e=>e.type==="tableRow",runner:(e,t,n)=>{let o=t.align,r=t.children.map((i,l)=>S(y({},i),{align:o[l]}));e.openNode(n),e.next(r),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="table_row",runner:(e,t)=>{e.openNode("tableRow"),e.next(t.content),e.closeNode()}}}));k(ge.node,{displayName:"NodeSchema<tableRow>",group:"Table"});k(ge.ctx,{displayName:"NodeSchemaCtx<tableRow>",group:"Table"});var be=X("table_cell",()=>S(y({},me.table_cell),{disableDropCursor:!0,parseMarkdown:{match:e=>e.type==="tableCell"&&!e.isHeader,runner:(e,t,n)=>{let o=t.align;e.openNode(n,{alignment:o}).openNode(e.schema.nodes.paragraph).next(t.children).closeNode().closeNode()}},toMarkdown:{match:e=>e.type.name==="table_cell",runner:(e,t)=>{e.openNode("tableCell").next(t.content).closeNode()}}}));k(be.node,{displayName:"NodeSchema<tableCell>",group:"Table"});k(be.ctx,{displayName:"NodeSchemaCtx<tableCell>",group:"Table"});var Ie=X("table_header",()=>S(y({},me.table_header),{disableDropCursor:!0,parseMarkdown:{match:e=>e.type==="tableCell"&&!!e.isHeader,runner:(e,t,n)=>{let o=t.align;e.openNode(n,{alignment:o}),e.openNode(e.schema.nodes.paragraph),e.next(t.children),e.closeNode(),e.closeNode()}},toMarkdown:{match:e=>e.type.name==="table_header",runner:(e,t)=>{e.openNode("tableCell"),e.next(t.content),e.closeNode()}}}));k(Ie.node,{displayName:"NodeSchema<tableHeader>",group:"Table"});k(Ie.ctx,{displayName:"NodeSchemaCtx<tableHeader>",group:"Table"});function Qn(e,t=3,n=3){let o=Array(n).fill(0).map(()=>be.type(e).createAndFill()),r=Array(n).fill(0).map(()=>Ie.type(e).createAndFill()),i=Array(t).fill(0).map((l,a)=>a===0?Ee.type(e).create(null,r):ge.type(e).create(null,o));return ae.type(e).create(null,i)}function we(e){return Oe(t=>t.type.spec.tableRole==="table")(e)}function le(e,t){let n=we(t.$from);if(!n)return;let o=A.get(n.node);if(!(e<0||e>=o.width))return o.cellsInRect({left:e,right:e+1,top:0,bottom:o.height}).map(r=>{let i=n.node.nodeAt(r);if(!i)return;let l=r+n.start;return{pos:l,start:l+1,node:i}}).filter(r=>r!=null)}function ie(e,t){let n=we(t.$from);if(!n)return;let o=A.get(n.node);if(!(e<0||e>=o.height))return o.cellsInRect({left:0,right:o.width,top:e,bottom:e+1}).map(r=>{let i=n.node.nodeAt(r);if(!i)return;let l=r+n.start;return{pos:l,start:l+1,node:i}}).filter(r=>r!=null)}function Tl(e){let t=we(e.$from);if(!t)return;let n=A.get(t.node);return n.cellsInRect({left:0,right:n.width,top:0,bottom:n.height}).map(o=>{let r=t.node.nodeAt(o),i=o+t.start;return{pos:i,start:i+1,node:r}})}function Ml(e){let t=Tl(e.selection);if(t&&t[0]){let n=e.doc.resolve(t[0].pos),o=t[t.length-1];if(o){let r=e.doc.resolve(o.pos);return ue(e.setSelection(new T(r,n)))}}return e}function eo(e,t,{map:n,tableStart:o,table:r},i){let l=Array(i).fill(0).reduce((s,c,f)=>s+r.child(f).nodeSize,o),a=Array(n.width).fill(0).map((s,c)=>{let f=r.nodeAt(n.map[c]);return be.type(e).createAndFill({alignment:f?.attrs.alignment})});return t.insert(l,ge.type(e).create(null,a)),t}function to(e){return(t,n)=>o=>{n=n??o.selection.from;let r=o.doc.resolve(n),i=Oe(s=>s.type.name==="table")(r),l=i?{node:i.node,from:i.start}:void 0,a=e==="row";if(l){let s=A.get(l.node);if(t>=0&&t<(a?s.height:s.width)){let c=s.positionAt(a?t:s.height-1,a?s.width-1:t,l.node),f=o.doc.resolve(l.from+c),u=a?T.rowSelection:T.colSelection,d=s.positionAt(a?t:0,a?0:t,l.node),h=o.doc.resolve(l.from+d);return ue(o.setSelection(u(f,h)))}}return o}}var Rl=to("row"),Nl=to("col");function Un(e){return e[0].map((t,n)=>e.map(o=>o[n]))}function no(e,t){let n=[],o=A.get(e);for(let r=0;r<o.height;r++){let i=e.child(r),l=[];for(let a=0;a<o.width;a++){if(!t[r][a])continue;let s=o.map[r*o.width+a],c=t[r][a],f=e.nodeAt(s).type.createChecked(Object.assign({},c.attrs),c.content,c.marks);l.push(f)}n.push(i.type.createChecked(i.attrs,l,i.marks))}return e.type.createChecked(e.attrs,n,e.marks)}function oo(e){let t=A.get(e),n=[];for(let o=0;o<t.height;o++){let r=[],i={};for(let l=0;l<t.width;l++){let a=t.map[o*t.width+l],s=e.nodeAt(a),c=t.findCell(a);if(i[a]||c.top!==o){r.push(null);continue}i[a]=!0,r.push(s)}n.push(r)}return n}function ro(e,t,n,o){let r=t[0]>n[0]?-1:1,i=e.splice(t[0],t.length),l=i.length%2===0?1:0,a;return a=r===-1?n[0]:n[n.length-1]-l,e.splice(a,0,...i),e}function Dl(e,t,n,o){let r=Un(oo(e.node));return r=ro(r,t,n),r=Un(r),no(e.node,r)}function vl(e,t,n,o){let r=oo(e.node);return r=ro(r,t,n),no(e.node,r)}function Xn(e,t){let n=e,o=e;for(let f=e;f>=0;f--){let u=le(f,t.selection);u&&u.forEach(d=>{let h=d.node.attrs.colspan+f-1;h>=n&&(n=f),h>o&&(o=h)})}for(let f=e;f<=o;f++){let u=le(f,t.selection);u&&u.forEach(d=>{let h=d.node.attrs.colspan+f-1;d.node.attrs.colspan>1&&h>o&&(o=h)})}let r=[];for(let f=n;f<=o;f++){let u=le(f,t.selection);u&&u.length&&r.push(f)}n=r[0],o=r[r.length-1];let i=le(n,t.selection),l=ie(0,t.selection),a=t.doc.resolve(i[i.length-1].pos),s;for(let f=o;f>=n;f--){let u=le(f,t.selection);if(u&&u.length){for(let d=l.length-1;d>=0;d--)if(l[d].pos===u[0].pos){s=u[0];break}if(s)break}}let c=t.doc.resolve(s.pos);return{$anchor:a,$head:c,indexes:r}}function Jn(e,t){let n=e,o=e;for(let f=e;f>=0;f--)ie(f,t.selection).forEach(u=>{let d=u.node.attrs.rowspan+f-1;d>=n&&(n=f),d>o&&(o=d)});for(let f=e;f<=o;f++)ie(f,t.selection).forEach(u=>{let d=u.node.attrs.rowspan+f-1;u.node.attrs.rowspan>1&&d>o&&(o=d)});let r=[];for(let f=n;f<=o;f++){let u=ie(f,t.selection);u&&u.length&&r.push(f)}n=r[0],o=r[r.length-1];let i=ie(n,t.selection),l=le(0,t.selection),a=t.doc.resolve(i[i.length-1].pos),s;for(let f=o;f>=n;f--){let u=ie(f,t.selection);if(u&&u.length){for(let d=l.length-1;d>=0;d--)if(l[d].pos===u[0].pos){s=u[0];break}if(s)break}}let c=t.doc.resolve(s.pos);return{$anchor:a,$head:c,indexes:r}}function Fl(e){let{tr:t,origin:n,target:o,select:r=!0,pos:i}=e,l=i!=null?t.doc.resolve(i):t.selection.$from,a=we(l);if(!a)return t;let{indexes:s}=Xn(n,t),{indexes:c}=Xn(o,t);if(s.includes(o))return t;let f=Dl(a,s,c),u=ue(t).replaceWith(a.pos,a.pos+a.node.nodeSize,f);if(!r)return u;let d=A.get(f),h=a.start,p=o,b=d.positionAt(d.height-1,p,f),w=u.doc.resolve(h+b),g=T.colSelection,C=d.positionAt(0,p,f),x=u.doc.resolve(h+C);return u.setSelection(g(w,x))}function Ll(e){let{tr:t,origin:n,target:o,select:r=!0,pos:i}=e,l=i!=null?t.doc.resolve(i):t.selection.$from,a=we(l);if(!a)return t;let{indexes:s}=Jn(n,t),{indexes:c}=Jn(o,t);if(s.includes(o))return t;let f=vl(a,s,c),u=ue(t).replaceWith(a.pos,a.pos+a.node.nodeSize,f);if(!r)return u;let d=A.get(f),h=a.start,p=o,b=d.positionAt(p,d.width-1,f),w=u.doc.resolve(h+b),g=T.rowSelection,C=d.positionAt(p,0,f),x=u.doc.resolve(h+C);return u.setSelection(g(w,x))}var Rt=v("GoToPrevTableCell",()=>()=>Ue(-1));k(Rt,{displayName:"Command<goToPrevTableCellCommand>",group:"Table"});var Nt=v("GoToNextTableCell",()=>()=>Ue(1));k(Nt,{displayName:"Command<goToNextTableCellCommand>",group:"Table"});var Dt=v("ExitTable",e=>()=>(t,n)=>{if(!E(t))return!1;let{$head:o}=t.selection,r=qt(o,ae.type(e));if(!r)return!1;let{to:i}=r,l=t.tr.replaceWith(i,i,en.type(e).createAndFill());return l.setSelection(F.near(l.doc.resolve(i),1)).scrollIntoView(),n?.(l),!0});k(Dt,{displayName:"Command<breakTableCommand>",group:"Table"});var lo=v("InsertTable",e=>({row:t,col:n}={})=>(o,r)=>{let{selection:i,tr:l}=o,{from:a}=i,s=Qn(e,t,n),c=l.replaceSelectionWith(s),f=F.findFrom(c.doc.resolve(a),1,!0);return f&&c.setSelection(f),r?.(c),!0});k(lo,{displayName:"Command<insertTableCommand>",group:"Table"});var io=v("MoveRow",()=>({from:e,to:t,pos:n}={})=>(o,r)=>{let{tr:i}=o;return!!r?.(Ll({tr:i,origin:e??0,target:t??0,pos:n,select:!0}))});k(io,{displayName:"Command<moveRowCommand>",group:"Table"});var ao=v("MoveCol",()=>({from:e,to:t,pos:n}={})=>(o,r)=>{let{tr:i}=o;return!!r?.(Fl({tr:i,origin:e??0,target:t??0,pos:n,select:!0}))});k(ao,{displayName:"Command<moveColCommand>",group:"Table"});var so=v("SelectRow",()=>(e={index:0})=>(t,n)=>{let{tr:o}=t;return!!n?.(Rl(e.index,e.pos)(o))});k(so,{displayName:"Command<selectRowCommand>",group:"Table"});var co=v("SelectCol",()=>(e={index:0})=>(t,n)=>{let{tr:o}=t;return!!n?.(Nl(e.index,e.pos)(o))});k(co,{displayName:"Command<selectColCommand>",group:"Table"});var uo=v("SelectTable",()=>()=>(e,t)=>{let{tr:n}=e;return!!t?.(Ml(n))});k(uo,{displayName:"Command<selectTableCommand>",group:"Table"});var fo=v("DeleteSelectedCells",()=>()=>(e,t)=>{let{selection:n}=e;if(!(n instanceof T))return!1;let o=n.isRowSelection(),r=n.isColSelection();return o&&r?Sn(e,t):r?Cn(e,t):yn(e,t)});k(fo,{displayName:"Command<deleteSelectedCellsCommand>",group:"Table"});var po=v("AddColBefore",()=>()=>wn);k(po,{displayName:"Command<addColBeforeCommand>",group:"Table"});var ho=v("AddColAfter",()=>()=>kn);k(ho,{displayName:"Command<addColAfterCommand>",group:"Table"});var mo=v("AddRowBefore",e=>()=>(t,n)=>{if(!E(t))return!1;if(n){let o=W(t);n(eo(e,t.tr,o,o.top))}return!0});k(mo,{displayName:"Command<addRowBeforeCommand>",group:"Table"});var go=v("AddRowAfter",e=>()=>(t,n)=>{if(!E(t))return!1;if(n){let o=W(t);n(eo(e,t.tr,o,o.bottom))}return!0});k(go,{displayName:"Command<addRowAfterCommand>",group:"Table"});var bo=v("SetAlign",()=>(e="left")=>xn("alignment",e));k(bo,{displayName:"Command<setAlignCommand>",group:"Table"});var wo=Se(e=>new _e(/^\|(?<col>\d+)[xX](?<row>\d+)\|\s$/,(t,n,o,r)=>{var i,l;let a=t.doc.resolve(o);if(!a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),ae.type(e)))return null;let s=Qn(e,Number((i=n.groups)==null?void 0:i.row),Number((l=n.groups)==null?void 0:l.col)),c=t.tr.replaceRangeWith(o,r,s);return c.setSelection(I.create(c.doc,o+3)).scrollIntoView()}));k(wo,{displayName:"InputRule<insertTableInputRule>",group:"Table"});var vt=He("tableKeymap",{NextCell:{shortcuts:["Mod-]","Tab"],command:e=>{let t=e.get(fe);return()=>t.call(Nt.key)}},PrevCell:{shortcuts:["Mod-[","Shift-Tab"],command:e=>{let t=e.get(fe);return()=>t.call(Rt.key)}},ExitTable:{shortcuts:["Mod-Enter"],command:e=>{let t=e.get(fe);return()=>t.call(Dt.key)}}});k(vt.ctx,{displayName:"KeymapCtx<table>",group:"Table"});k(vt.shortcuts,{displayName:"Keymap<table>",group:"Table"});var xt="footnote_definition",Yn="footnoteDefinition",Ft=X("footnote_definition",()=>({group:"block",content:"block+",defining:!0,attrs:{label:{default:""}},parseDOM:[{tag:`dl[data-type="${xt}"]`,getAttrs:e=>{if(!(e instanceof HTMLElement))throw ke(e);return{label:e.dataset.label}},contentElement:"dd"}],toDOM:e=>{let t=e.attrs.label;return["dl",{"data-label":t,"data-type":xt},["dt",t],["dd",0]]},parseMarkdown:{match:({type:e})=>e===Yn,runner:(e,t,n)=>{e.openNode(n,{label:t.label}).next(t.children).closeNode()}},toMarkdown:{match:e=>e.type.name===xt,runner:(e,t)=>{e.openNode(Yn,void 0,{label:t.attrs.label,identifier:t.attrs.label}).next(t.content).closeNode()}}}));k(Ft.ctx,{displayName:"NodeSchemaCtx<footnodeDef>",group:"footnote"});k(Ft.node,{displayName:"NodeSchema<footnodeDef>",group:"footnote"});var St="footnote_reference",Lt=X("footnote_reference",()=>({group:"inline",inline:!0,atom:!0,attrs:{label:{default:""}},parseDOM:[{tag:`sup[data-type="${St}"]`,getAttrs:e=>{if(!(e instanceof HTMLElement))throw ke(e);return{label:e.dataset.label}}}],toDOM:e=>{let t=e.attrs.label;return["sup",{"data-label":t,"data-type":St},t]},parseMarkdown:{match:({type:e})=>e==="footnoteReference",runner:(e,t,n)=>{e.addNode(n,{label:t.label})}},toMarkdown:{match:e=>e.type.name===St,runner:(e,t)=>{e.addNode("footnoteReference",void 0,void 0,{label:t.attrs.label,identifier:t.attrs.label})}}}));k(Lt.ctx,{displayName:"NodeSchemaCtx<footnodeRef>",group:"footnote"});k(Lt.node,{displayName:"NodeSchema<footnodeRef>",group:"footnote"});var ko=tn.extendSchema(e=>t=>{let n=e(t);return S(y({},n),{attrs:S(y({},n.attrs),{checked:{default:null}}),parseDOM:[{tag:'li[data-item-type="task"]',getAttrs:o=>{if(!(o instanceof HTMLElement))throw ke(o);return{label:o.dataset.label,listType:o.dataset.listType,spread:o.dataset.spread,checked:o.dataset.checked?o.dataset.checked==="true":null}}},...n?.parseDOM||[]],toDOM:o=>n.toDOM&&o.attrs.checked==null?n.toDOM(o):["li",{"data-item-type":"task","data-label":o.attrs.label,"data-list-type":o.attrs.listType,"data-spread":o.attrs.spread,"data-checked":o.attrs.checked},0],parseMarkdown:{match:({type:o})=>o==="listItem",runner:(o,r,i)=>{if(r.checked==null){n.parseMarkdown.runner(o,r,i);return}let l=r.label!=null?`${r.label}.`:"\u2022",a=r.checked!=null?!!r.checked:null,s=r.label!=null?"ordered":"bullet",c=r.spread!=null?`${r.spread}`:"true";o.openNode(i,{label:l,listType:s,spread:c,checked:a}),o.next(r.children),o.closeNode()}},toMarkdown:{match:o=>o.type.name==="list_item",runner:(o,r)=>{if(r.attrs.checked==null){n.toMarkdown.runner(o,r);return}let i=r.attrs.label,l=r.attrs.listType,a=r.attrs.spread==="true",s=r.attrs.checked;o.openNode("listItem",void 0,{label:i,listType:l,spread:a,checked:s}),o.next(r.content),o.closeNode()}}})});k(ko,{displayName:"NodeSchema<listItem>",group:"ListItem"});var Co=Se(()=>new _e(/^\[(?<checked>\s|x)\]\s$/,(e,t,n,o)=>{var r;let i=e.doc.resolve(n),l=0,a=i.node(l);for(;a&&a.type.name!=="list_item";)l--,a=i.node(l);if(!a||a.attrs.checked!=null)return null;let s=((r=t.groups)==null?void 0:r.checked)==="x",c=i.before(l),f=e.tr;return f.deleteRange(n,o).setNodeMarkup(c,void 0,S(y({},a.attrs),{checked:s})),f}));k(Co,{displayName:"InputRule<wrapInTaskListInputRule>",group:"ListItem"});var zl=[Mt,vt].flat(),El=[wo,Co],Il=[Zn],yo=de(()=>Dn);k(yo,{displayName:"Prose<autoInsertSpanPlugin>",group:"Prose"});var Pl=de(()=>Tn({}));k(Pl,{displayName:"Prose<columnResizingPlugin>",group:"Prose"});var xo=de(()=>Rn({allowTableNodeSelection:!0}));k(xo,{displayName:"Prose<tableEditingPlugin>",group:"Prose"});var zt=Zt("remarkGFM",()=>ze);k(zt.plugin,{displayName:"Remark<remarkGFMPlugin>",group:"Remark"});k(zt.options,{displayName:"RemarkConfig<remarkGFMPlugin>",group:"Remark"});var _l=new $("MILKDOWN_KEEP_TABLE_ALIGN_PLUGIN");function Ol(e,t){let n=0;return t.forEach((o,r,i)=>{o===e&&(n=i)}),n}var So=de(()=>new G({key:_l,appendTransaction:(e,t,n)=>{let o,r=(i,l)=>{if(o||(o=n.tr),i.type.name!=="table_cell")return;let a=n.doc.resolve(l),s=a.node(a.depth),c=a.node(a.depth-1).firstChild;if(!c)return;let f=Ol(i,s),u=c.maybeChild(f);if(!u)return;let d=u.attrs.alignment,h=i.attrs.alignment;d!==h&&o.setNodeMarkup(l,void 0,S(y({},i.attrs),{alignment:d}))};return t.doc!==n.doc&&n.doc.descendants(r),o}}));k(So,{displayName:"Prose<keepTableAlignPlugin>",group:"Prose"});var Hl=[So,yo,zt,xo].flat(),$l=[ko,ae,Ee,ge,Ie,be,Ft,Lt,At,he].flat(),Bl=[Nt,Rt,Dt,lo,io,ao,so,co,uo,fo,mo,go,po,ho,bo,Tt],as=[$l,El,Il,zl,Bl,Hl].flat();export{T as a,Ye as b,he as c,Tt as d,ae as e,Qn as f,we as g,io as h,ao as i,so as j,co as k,fo as l,po as m,ho as n,mo as o,go as p,bo as q,as as r};
