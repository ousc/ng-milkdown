import{A as Ze,B as Rt,C as Ie,D as q,R as _t,S as Lt,j as $,k as Ne,l as Mt,o as me,r as ce,s as Ke,u as Dt,v as Qe,w as Et,x as Xe,y as Ye,z as L}from "./chunk-4BCIMHJT.js";var On=0,F=class{constructor(e, t){this.from=e,this.to=t}},b=class{constructor(e={}){this.id=On++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=_.match(e)), t=>{let n=e(t);return n===void 0?null:[this,n]}}};b.closedBy=new b({deserialize: i=>i.split(" ")});b.openedBy=new b({deserialize: i=>i.split(" ")});b.group=new b({deserialize: i=>i.split(" ")});b.isolate=new b({deserialize: i=>{if(i&&i!="rtl"&&i!="ltr"&&i!="auto")throw new RangeError("Invalid value for isolate: "+i);return i||"auto"}});b.contextHash=new b({perNode:!0});b.lookAhead=new b({perNode:!0});b.mounted=new b({perNode:!0});var le=class{constructor(e, t, n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[b.mounted.id]}},Mn=Object.create(null),_=class i{constructor(e, t, n, r=0){this.name=e,this.props=t,this.id=n,this.flags=r}static define(e){let t=e.props&&e.props.length?Object.create(null):Mn,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),r=new i(e.name||"",t,e.id,n);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(r)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return r}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(b.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let r of n.split(" "))t[r]=e[n];return n=>{for(let r=n.prop(b.group),s=-1; s<(r?r.length:0); s++){let l=t[s<0?n.name:r[s]];if(l)return l}}}};_.none=new _("",Object.create(null),0,8);var Me=class i{constructor(e){this.types=e;for(let t=0; t<e.length; t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let r=null;for(let s of e){let l=s(n);l&&(r||(r=Object.assign({},n.props)),r[l[0].id]=l[1])}t.push(r?new _(n.name,r,n.id,n.flags):n)}return new i(t)}},Be=new WeakMap,Ft=new WeakMap,I=function(i){return i[i.ExcludeBuffers=1]="ExcludeBuffers",i[i.IncludeAnonymous=2]="IncludeAnonymous",i[i.IgnoreMounts=4]="IgnoreMounts",i[i.IgnoreOverlays=8]="IgnoreOverlays",i}(I||{}),A=class i{constructor(e, t, n, r, s){if(this.type=e,this.children=t,this.positions=n,this.length=r,this.props=null,s&&s.length){this.props=Object.create(null);for(let[l,o]of s)this.props[typeof l=="number"?l:l.id]=o}}toString(){let e=le.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let n of this.children){let r=n.toString();r&&(t&&(t+=","),t+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new de(this.topNode,e)}cursorAt(e, t=0, n=0){let r=Be.get(this)||this.topNode,s=new de(r);return s.moveTo(e,t),Be.set(this,s._tree),s}get topNode(){return new z(this,0,0,null)}resolve(e, t=0){let n=ke(Be.get(this)||this.topNode,e,t,!1);return Be.set(this,n),n}resolveInner(e, t=0){let n=ke(Ft.get(this)||this.topNode,e,t,!0);return Ft.set(this,n),n}resolveStack(e, t=0){return Dn(this,e,t)}iterate(e){let{enter:t,leave:n,from:r=0,to:s=this.length}=e,l=e.mode||0,o=(l&I.IncludeAnonymous)>0;for(let a=this.cursor(l|I.IncludeAnonymous);;){let f=!1;if(a.from<=s&&a.to>=r&&(!o&&a.type.isAnonymous||t(a)!==!1)){if(a.firstChild())continue;f=!0}for(; f&&n&&(o||!a.type.isAnonymous)&&n(a),!a.nextSibling();){if(!a.parent())return;f=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:ht(_.none,this.children,this.positions,0,this.children.length,0,this.length,(t, n, r)=>new i(this.type,t,n,r,this.propValues),e.makeTree||((t, n, r)=>new i(_.none,t,n,r)))}static build(e){return En(e)}};A.empty=new A(_.none,[],[],0);var et=class i{constructor(e, t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new i(this.buffer,this.index)}},ee=class i{constructor(e, t, n){this.buffer=e,this.length=t,this.set=n}get type(){return _.none}toString(){let e=[];for(let t=0; t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],r=this.set.types[t],s=r.name;if(/\W/.test(s)&&!r.isError&&(s=JSON.stringify(s)),e+=4,n==e)return s;let l=[];for(; e<n;)l.push(this.childString(e)),e=this.buffer[e+3];return s+"("+l.join(",")+")"}findChild(e, t, n, r, s){let{buffer:l}=this,o=-1;for(let a=e; a!=t&&!(qt(s,r,l[a+1],l[a+2])&&(o=a,n>0)); a=l[a+3]);return o}slice(e, t, n){let r=this.buffer,s=new Uint16Array(t-e),l=0;for(let o=e,a=0; o<t;){s[a++]=r[o++],s[a++]=r[o++]-n;let f=s[a++]=r[o++]-n;s[a++]=r[o++]-e,l=Math.max(l,f)}return new i(s,l,this.set)}};function qt(i, e, t, n){switch(i){case-2:return t<e;case-1:return n>=e&&t<e;case 0:return t<e&&n>e;case 1:return t<=e&&n>e;case 2:return n>e;case 4:return!0}}function ke(i, e, t, n){for(var r; i.from==i.to||(t<1?i.from>=e:i.from>e)||(t>-1?i.to<=e:i.to<e);){let l=!n&&i instanceof z&&i.index<0?null:i.parent;if(!l)return i;i=l}let s=n?0:I.IgnoreOverlays;if(n)for(let l=i,o=l.parent; o; l=o,o=l.parent)l instanceof z&&l.index<0&&((r=o.enter(e,t,s))===null||r===void 0?void 0:r.from)!=l.from&&(i=o);for(;;){let l=i.enter(e,t,s);if(!l)return i;i=l}}var De=class{cursor(e=0){return new de(this,e)}getChild(e, t=null, n=null){let r=zt(this,e,t,n);return r.length?r[0]:null}getChildren(e, t=null, n=null){return zt(this,e,t,n)}resolve(e, t=0){return ke(this,e,t,!1)}resolveInner(e, t=0){return ke(this,e,t,!0)}matchContext(e){return tt(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(; t;){let r=t.lastChild;if(!r||r.to!=t.to)break;r.type.isError&&r.from==r.to?(n=t,t=r.prevSibling):t=r}return n}get node(){return this}get next(){return this.parent}},z=class i extends De{constructor(e, t, n, r){super(),this._tree=e,this.from=t,this.index=n,this._parent=r}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e, t, n, r, s=0){for(let l=this;;){for(let{children:o,positions:a}=l._tree,f=t>0?o.length:-1; e!=f; e+=t){let h=o[e],u=a[e]+l.from;if(qt(r,n,u,u+h.length)){if(h instanceof ee){if(s&I.ExcludeBuffers)continue;let p=h.findChild(0,h.buffer.length,t,n-u,r);if(p>-1)return new oe(new nt(l,h,e,u),null,p)}else if(s&I.IncludeAnonymous||!h.type.isAnonymous||ft(h)){let p;if(!(s&I.IgnoreMounts)&&(p=le.get(h))&&!p.overlay)return new i(p.tree,u,e,l);let m=new i(h,u,e,l);return s&I.IncludeAnonymous||!m.type.isAnonymous?m:m.nextChild(t<0?h.children.length-1:0,t,n,r)}}}if(s&I.IncludeAnonymous||!l.type.isAnonymous||(l.index>=0?e=l.index+t:e=t<0?-1:l._parent._tree.children.length,l=l._parent,!l))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e, t, n=0){let r;if(!(n&I.IgnoreOverlays)&&(r=le.get(this._tree))&&r.overlay){let s=e-this.from;for(let{from:l,to:o}of r.overlay)if((t>0?l<=s:l<s)&&(t<0?o>=s:o>s))return new i(r.tree,r.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(; e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function zt(i, e, t, n){let r=i.cursor(),s=[];if(!r.firstChild())return s;if(t!=null){for(let l=!1; !l;)if(l=r.type.is(t),!r.nextSibling())return s}for(;;){if(n!=null&&r.type.is(n))return s;if(r.type.is(e)&&s.push(r.node),!r.nextSibling())return n==null?s:[]}}function tt(i, e, t=e.length-1){for(let n=i; t>=0; n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[t]&&e[t]!=n.name)return!1;t--}}return!0}var nt=class{constructor(e, t, n, r){this.parent=e,this.buffer=t,this.index=n,this.start=r}},oe=class i extends De{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e, t, n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e, t, n){let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.context.start,n);return s<0?null:new i(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e, t, n=0){if(n&I.ExcludeBuffers)return null;let{buffer:r}=this.context,s=r.findChild(this.index+4,r.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new i(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new i(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new i(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,r=this.index+4,s=n.buffer[this.index+3];if(s>r){let l=n.buffer[this.index+1];e.push(n.slice(r,s,l)),t.push(0)}return new A(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function Gt(i){if(!i.length)return null;let e=0,t=i[0];for(let s=1; s<i.length; s++){let l=i[s];(l.from>t.from||l.to<t.to)&&(t=l,e=s)}let n=t instanceof z&&t.index<0?null:t.parent,r=i.slice();return n?r[e]=n:r.splice(e,1),new rt(r,t)}var rt=class{constructor(e, t){this.heads=e,this.node=t}get next(){return Gt(this.heads)}};function Dn(i, e, t){let n=i.resolveInner(e,t),r=null;for(let s=n instanceof z?n:n.context.parent; s; s=s.parent)if(s.index<0){let l=s.parent;(r||(r=[n])).push(l.resolve(e,t)),s=l}else{let l=le.get(s.tree);if(l&&l.overlay&&l.overlay[0].from<=e&&l.overlay[l.overlay.length-1].to>=e){let o=new z(l.tree,l.overlay[0].from+s.from,-1,s);(r||(r=[n])).push(ke(o,e,t,!1))}}return r?Gt(r):n}var de=class{get name(){return this.type.name}constructor(e, t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof z)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent; n; n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e, t){this.index=e;let{start:n,buffer:r}=this.buffer;return this.type=t||r.set.types[r.buffer[e]],this.from=n+r.buffer[e+1],this.to=n+r.buffer[e+2],!0}yield(e){return e?e instanceof z?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e, t, n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:r}=this.buffer,s=r.findChild(this.index+4,r.buffer[this.index+3],e,t-this.buffer.start,n);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e, t, n=this.mode){return this.buffer?n&I.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&I.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&I.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let r=n<0?0:this.stack[n]+4;if(this.index!=r)return this.yieldBuf(t.findChild(r,this.index,-1,0,4))}else{let r=t.buffer[this.index+3];if(r<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(r)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:r}=this;if(r){if(e>0){if(this.index<r.buffer.buffer.length)return!1}else for(let s=0; s<this.index; s++)if(r.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:n}=r)}else({index:t,_parent:n}=this._tree);for(; n; {index:t,_parent:n}=n)if(t>-1)for(let s=t+e,l=e<0?-1:n._tree.children.length; s!=l; s+=e){let o=n._tree.children[s];if(this.mode&I.IncludeAnonymous||o instanceof ee||!o.type.isAnonymous||ft(o))return!1}return!0}move(e, t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e, t=0){for(; (this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(; this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let r=this.index,s=this.stack.length; s>=0;){for(let l=e; l; l=l._parent)if(l.index==r){if(r==this.index)return l;t=l,n=s+1;break e}r=this.stack[--s]}for(let r=n; r<this.stack.length; r++)t=new oe(this.buffer,t,this.stack[r]);return this.bufferNode=new oe(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e, t){for(let n=0;;){let r=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(r=!0)}for(;;){if(r&&t&&t(this),r=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,r=!0}}}matchContext(e){if(!this.buffer)return tt(this.node.parent,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let r=e.length-1,s=this.stack.length-1; r>=0; s--){if(s<0)return tt(this._tree,e,r);let l=n[t.buffer[this.stack[s]]];if(!l.isAnonymous){if(e[r]&&e[r]!=l.name)return!1;r--}}return!0}};function ft(i){return i.children.some(e=>e instanceof ee||!e.type.isAnonymous||ft(e))}function En(i){var e;let{buffer:t,nodeSet:n,maxBufferLength:r=1024,reused:s=[],minRepeatType:l=n.types.length}=i,o=Array.isArray(t)?new et(t,t.length):t,a=n.types,f=0,h=0;function u(x, T, g, B, S, O){let{id:y,start:k,end:P,size:N}=o,R=h,Z=f;for(; N<0;)if(o.next(),N==-1){let X=s[y];g.push(X),B.push(k-x);return}else if(N==-3){f=y;return}else if(N==-4){h=y;return}else throw new RangeError(`Unrecognized record size: ${N}`);let ge=a[y],Pe,ie,Bt=k-x;if(P-k<=r&&(ie=D(o.pos-T,S))){let X=new Uint16Array(ie.size-ie.skip),U=o.pos-ie.size,V=X.length;for(; o.pos>U;)V=M(ie.start,X,V);Pe=new ee(X,P-ie.start,n),Bt=ie.start-x}else{let X=o.pos-N;o.next();let U=[],V=[],se=y>=l?y:-1,ue=0,Te=P;for(; o.pos>X;)se>=0&&o.id==se&&o.size>=0?(o.end<=Te-r&&(w(U,V,k,ue,o.end,Te,se,R,Z),ue=U.length,Te=o.end),o.next()):O>2500?p(k,X,U,V):u(k,X,U,V,se,O+1);if(se>=0&&ue>0&&ue<U.length&&w(U,V,k,ue,k,Te,se,R,Z),U.reverse(),V.reverse(),se>-1&&ue>0){let Ot=m(ge,Z);Pe=ht(ge,U,V,0,U.length,0,P-k,Ot,Ot)}else Pe=v(ge,U,V,P-k,R-P,Z)}g.push(Pe),B.push(Bt)}function p(x, T, g, B){let S=[],O=0,y=-1;for(; o.pos>T;){let{id:k,start:P,end:N,size:R}=o;if(R>4)o.next();else{if(y>-1&&P<y)break;y<0&&(y=N-r),S.push(k,P,N),O++,o.next()}}if(O){let k=new Uint16Array(O*4),P=S[S.length-2];for(let N=S.length-3,R=0; N>=0; N-=3)k[R++]=S[N],k[R++]=S[N+1]-P,k[R++]=S[N+2]-P,k[R++]=R;g.push(new ee(k,S[2]-P,n)),B.push(P-x)}}function m(x, T){return(g, B, S)=>{let O=0,y=g.length-1,k,P;if(y>=0&&(k=g[y])instanceof A){if(!y&&k.type==x&&k.length==S)return k;(P=k.prop(b.lookAhead))&&(O=B[y]+k.length+P)}return v(x,g,B,S,O,T)}}function w(x, T, g, B, S, O, y, k, P){let N=[],R=[];for(; x.length>B;)N.push(x.pop()),R.push(T.pop()+g-S);x.push(v(n.types[y],N,R,O-S,k-O,P)),T.push(S-g)}function v(x, T, g, B, S, O, y){if(O){let k=[b.contextHash,O];y=y?[k].concat(y):[k]}if(S>25){let k=[b.lookAhead,S];y=y?[k].concat(y):[k]}return new A(x,T,g,B,y)}function D(x, T){let g=o.fork(),B=0,S=0,O=0,y=g.end-r,k={size:0,start:0,skip:0};e:for(let P=g.pos-x; g.pos>P;){let N=g.size;if(g.id==T&&N>=0){k.size=B,k.start=S,k.skip=O,O+=4,B+=4,g.next();continue}let R=g.pos-N;if(N<0||R<P||g.start<y)break;let Z=g.id>=l?4:0,ge=g.start;for(g.next(); g.pos>R;){if(g.size<0)if(g.size==-3)Z+=4;else break e;else g.id>=l&&(Z+=4);g.next()}S=ge,B+=N,O+=Z}return(T<0||B==x)&&(k.size=B,k.start=S,k.skip=O),k.size>4?k:void 0}function M(x, T, g){let{id:B,start:S,end:O,size:y}=o;if(o.next(),y>=0&&B<l){let k=g;if(y>4){let P=o.pos-(y-4);for(; o.pos>P;)g=M(x,T,g)}T[--g]=k,T[--g]=O-x,T[--g]=S-x,T[--g]=B}else y==-3?f=B:y==-4&&(h=B);return g}let E=[],C=[];for(; o.pos>0;)u(i.start||0,i.bufferStart||0,E,C,-1,0);let j=(e=i.length)!==null&&e!==void 0?e:E.length?C[0]+E[0].length:0;return new A(a[i.topID],E.reverse(),C.reverse(),j)}var jt=new WeakMap;function Oe(i, e){if(!i.isAnonymous||e instanceof ee||e.type!=i)return 1;let t=jt.get(e);if(t==null){t=1;for(let n of e.children){if(n.type!=i||!(n instanceof A)){t=1;break}t+=Oe(i,n)}jt.set(e,t)}return t}function ht(i, e, t, n, r, s, l, o, a){let f=0;for(let w=n; w<r; w++)f+=Oe(i,e[w]);let h=Math.ceil(f*1.5/8),u=[],p=[];function m(w, v, D, M, E){for(let C=D; C<M;){let j=C,x=v[C],T=Oe(i,w[C]);for(C++; C<M; C++){let g=Oe(i,w[C]);if(T+g>=h)break;T+=g}if(C==j+1){if(T>h){let g=w[j];m(g.children,g.positions,0,g.children.length,v[j]+E);continue}u.push(w[j])}else{let g=v[C-1]+w[C-1].length-x;u.push(ht(i,w,v,j,C,x,g,null,a))}p.push(x+E-s)}}return m(e,t,n,r,0),(o||a)(u,p,l)}var Ut=class{constructor(){this.map=new WeakMap}setBuffer(e, t, n){let r=this.map.get(e);r||this.map.set(e,r=new Map),r.set(t,n)}getBuffer(e, t){let n=this.map.get(e);return n&&n.get(t)}set(e, t){e instanceof oe?this.setBuffer(e.context.buffer,e.index,t):e instanceof z&&this.map.set(e.tree,t)}get(e){return e instanceof oe?this.getBuffer(e.context.buffer,e.index):e instanceof z?this.map.get(e.tree):void 0}cursorSet(e, t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}},Y=class i{constructor(e, t, n, r, s=!1, l=!1){this.from=e,this.to=t,this.tree=n,this.offset=r,this.open=(s?1:0)|(l?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e, t=[], n=!1){let r=[new i(0,e.length,e,0,!1,n)];for(let s of t)s.to>e.length&&r.push(s);return r}static applyChanges(e, t, n=128){if(!t.length)return e;let r=[],s=1,l=e.length?e[0]:null;for(let o=0,a=0,f=0;; o++){let h=o<t.length?t[o]:null,u=h?h.fromA:1e9;if(u-a>=n)for(; l&&l.from<u;){let p=l;if(a>=p.from||u<=p.to||f){let m=Math.max(p.from,a)-f,w=Math.min(p.to,u)-f;p=m>=w?null:new i(m,w,p.tree,p.offset+f,o>0,!!h)}if(p&&r.push(p),l.to>u)break;l=s<e.length?e[s++]:null}if(!h)break;a=h.toA,f=h.toA-h.toB}return r}},be=class{startParse(e, t, n){return typeof e=="string"&&(e=new it(e)),n=n?n.length?n.map(r=>new F(r.from,r.to)):[new F(0,0)]:[new F(0,e.length)],this.createParse(e,t||[],n)}parse(e, t, n){let r=this.startParse(e,t,n);for(;;){let s=r.advance();if(s)return s}}},it=class{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e, t){return this.string.slice(e,t)}};function Br(i){return(e, t, n, r)=>new ot(e,i,t,n,r)}var Ee=class{constructor(e, t, n, r, s){this.parser=e,this.parse=t,this.overlay=n,this.target=r,this.from=s}};function Wt(i){if(!i.length||i.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(i))}var st=class{constructor(e, t, n, r, s, l, o){this.parser=e,this.predicate=t,this.mounts=n,this.index=r,this.start=s,this.target=l,this.prev=o,this.depth=0,this.ranges=[]}},lt=new b({perNode:!0}),ot=class{constructor(e, t, n, r, s){this.nest=t,this.input=n,this.fragments=r,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let n=this.baseParse.advance();if(!n)return null;if(this.baseParse=null,this.baseTree=n,this.startInner(),this.stoppedAt!=null)for(let r of this.inner)r.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let n=this.baseTree;return this.stoppedAt!=null&&(n=new A(n.type,n.children,n.positions,n.length,n.propValues.concat([[lt,this.stoppedAt]]))),n}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[b.mounted.id]=new le(t,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone; t<this.inner.length; t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone; t<this.inner.length; t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new at(this.fragments),t=null,n=null,r=new de(new z(this.baseTree,this.ranges[0].from,0,null),I.IncludeAnonymous|I.IgnoreMounts);e:for(let s,l;;){let o=!0,a;if(this.stoppedAt!=null&&r.from>=this.stoppedAt)o=!1;else if(e.hasNode(r)){if(t){let f=t.mounts.find(h=>h.frag.from<=r.from&&h.frag.to>=r.to&&h.mount.overlay);if(f)for(let h of f.mount.overlay){let u=h.from+f.pos,p=h.to+f.pos;u>=r.from&&p<=r.to&&!t.ranges.some(m=>m.from<p&&m.to>u)&&t.ranges.push({from:u,to:p})}}o=!1}else if(n&&(l=Rn(n.ranges,r.from,r.to)))o=l!=2;else if(!r.type.isAnonymous&&(s=this.nest(r,this.input))&&(r.from<r.to||!s.overlay)){r.tree||_n(r);let f=e.findMounts(r.from,s.parser);if(typeof s.overlay=="function")t=new st(s.parser,s.overlay,f,this.inner.length,r.from,r.tree,t);else{let h=Vt(this.ranges,s.overlay||(r.from<r.to?[new F(r.from,r.to)]:[]));h.length&&Wt(h),(h.length||!s.overlay)&&this.inner.push(new Ee(s.parser,h.length?s.parser.startParse(this.input,$t(f,h),h):s.parser.startParse(""),s.overlay?s.overlay.map(u=>new F(u.from-r.from,u.to-r.from)):null,r.tree,h.length?h[0].from:r.from)),s.overlay?h.length&&(n={ranges:h,depth:0,prev:n}):o=!1}}else if(t&&(a=t.predicate(r))&&(a===!0&&(a=new F(r.from,r.to)),a.from<a.to)){let f=t.ranges.length-1;f>=0&&t.ranges[f].to==a.from?t.ranges[f]={from:t.ranges[f].from,to:a.to}:t.ranges.push(a)}if(o&&r.firstChild())t&&t.depth++,n&&n.depth++;else for(; !r.nextSibling();){if(!r.parent())break e;if(t&&!--t.depth){let f=Vt(this.ranges,t.ranges);f.length&&(Wt(f),this.inner.splice(t.index,0,new Ee(t.parser,t.parser.startParse(this.input,$t(t.mounts,f),f),t.ranges.map(h=>new F(h.from-t.start,h.to-t.start)),t.target,f[0].from))),t=t.prev}n&&!--n.depth&&(n=n.prev)}}}};function Rn(i, e, t){for(let n of i){if(n.from>=t)break;if(n.to>e)return n.from<=e&&n.to>=t?2:1}return 0}function Ht(i, e, t, n, r, s){if(e<t){let l=i.buffer[e+1];n.push(i.slice(e,t,l)),r.push(l-s)}}function _n(i){let{node:e}=i,t=[],n=e.context.buffer;do t.push(i.index),i.parent();while(!i.tree);let r=i.tree,s=r.children.indexOf(n),l=r.children[s],o=l.buffer,a=[s];function f(h, u, p, m, w, v){let D=t[v],M=[],E=[];Ht(l,h,D,M,E,m);let C=o[D+1],j=o[D+2];a.push(M.length);let x=v?f(D+4,o[D+3],l.set.types[o[D]],C,j-C,v-1):e.toTree();return M.push(x),E.push(C-m),Ht(l,o[D+3],u,M,E,m),new A(p,M,E,w)}r.children[s]=f(0,o.length,_.none,0,l.length,t.length-1);for(let h of a){let u=i.tree.children[h],p=i.tree.positions[h];i.yield(new z(u,p+i.from,h,i._tree))}}var Re=class{constructor(e, t){this.offset=t,this.done=!1,this.cursor=e.cursor(I.IncludeAnonymous|I.IgnoreMounts)}moveTo(e){let{cursor:t}=this,n=e-this.offset;for(; !this.done&&t.from<n;)t.to>=e&&t.enter(n,1,I.IgnoreOverlays|I.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof A)t=t.children[0];else break}return!1}},at=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=(t=n.tree.prop(lt))!==null&&t!==void 0?t:n.to,this.inner=new Re(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(; this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(lt))!==null&&e!==void 0?e:t.to,this.inner=new Re(t.tree,-t.offset)}}findMounts(e, t){var n;let r=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let s=this.inner.cursor.node; s; s=s.parent){let l=(n=s.tree)===null||n===void 0?void 0:n.prop(b.mounted);if(l&&l.parser==t)for(let o=this.fragI; o<this.fragments.length; o++){let a=this.fragments[o];if(a.from>=s.to)break;a.tree==this.curFrag.tree&&r.push({frag:a,pos:s.from-a.offset,mount:l})}}}return r}};function Vt(i, e){let t=null,n=e;for(let r=1,s=0; r<i.length; r++){let l=i[r-1].to,o=i[r].from;for(; s<n.length; s++){let a=n[s];if(a.from>=o)break;a.to<=l||(t||(n=t=e.slice()),a.from<l?(t[s]=new F(a.from,l),a.to>o&&t.splice(s+1,0,new F(o,a.to))):a.to>o?t[s--]=new F(o,a.to):t.splice(s--,1))}}return n}function Ln(i, e, t, n){let r=0,s=0,l=!1,o=!1,a=-1e9,f=[];for(;;){let h=r==i.length?1e9:l?i[r].to:i[r].from,u=s==e.length?1e9:o?e[s].to:e[s].from;if(l!=o){let p=Math.max(a,t),m=Math.min(h,u,n);p<m&&f.push(new F(p,m))}if(a=Math.min(h,u),a==1e9)break;h==a&&(l?(l=!1,r++):l=!0),u==a&&(o?(o=!1,s++):o=!0)}return f}function $t(i, e){let t=[];for(let{pos:n,mount:r,frag:s}of i){let l=n+(r.overlay?r.overlay[0].from:0),o=l+r.tree.length,a=Math.max(s.from,l),f=Math.min(s.to,o);if(r.overlay){let h=r.overlay.map(p=>new F(p.from+n,p.to+n)),u=Ln(e,h,a,f);for(let p=0,m=a;; p++){let w=p==u.length,v=w?f:u[p].from;if(v>m&&t.push(new Y(m,v,r.tree,-l,s.from>=m||s.openStart,s.to<=v||s.openEnd)),w)break;m=u[p].to}}else t.push(new Y(a,f,r.tree,-l,s.from>=l||s.openStart,s.to<=o||s.openEnd))}return t}var Fn=0,W=class i{constructor(e, t, n, r){this.name=e,this.set=t,this.base=n,this.modified=r,this.id=Fn++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e, t){let n=typeof e=="string"?e:"?";if(e instanceof i&&(t=e),t?.base)throw new Error("Can not derive from a modified tag");let r=new i(n,[],null,[]);if(r.set.push(r),t)for(let s of t.set)r.set.push(s);return r}static defineModifier(e){let t=new ze(e);return n=>n.modified.indexOf(t)>-1?n:ze.get(n.base||n,n.modified.concat(t).sort((r, s)=>r.id-s.id))}},zn=0,ze=class i{constructor(e){this.name=e,this.instances=[],this.id=zn++}static get(e, t){if(!t.length)return e;let n=t[0].instances.find(o=>o.base==e&&jn(t,o.modified));if(n)return n;let r=[],s=new W(e.name,r,e,t);for(let o of t)o.instances.push(s);let l=Un(t);for(let o of e.set)if(!o.modified.length)for(let a of l)r.push(i.get(o,a));return s}};function jn(i, e){return i.length==e.length&&i.every((t, n)=>t==e[n])}function Un(i){let e=[[]];for(let t=0; t<i.length; t++)for(let n=0,r=e.length; n<r; n++)e.push(e[n].concat(i[t]));return e.sort((t, n)=>n.length-t.length)}function Qt(i){let e=Object.create(null);for(let t in i){let n=i[t];Array.isArray(n)||(n=[n]);for(let r of t.split(" "))if(r){let s=[],l=2,o=r;for(let u=0;;){if(o=="..."&&u>0&&u+3==r.length){l=1;break}let p=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(o);if(!p)throw new RangeError("Invalid path: "+r);if(s.push(p[0]=="*"?"":p[0][0]=='"'?JSON.parse(p[0]):p[0]),u+=p[0].length,u==r.length)break;let m=r[u++];if(u==r.length&&m=="!"){l=0;break}if(m!="/")throw new RangeError("Invalid path: "+r);o=r.slice(u)}let a=s.length-1,f=s[a];if(!f)throw new RangeError("Invalid path: "+r);let h=new pe(n,l,a>0?s.slice(0,a):null);e[f]=h.sort(e[f])}}return Xt.add(e)}var Xt=new b,pe=class{constructor(e, t, n, r){this.tags=e,this.mode=t,this.context=n,this.next=r}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};pe.empty=new pe([],2,null);function pt(i, e){let t=Object.create(null);for(let s of i)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let l of s.tag)t[l.id]=s.class;let{scope:n,all:r=null}=e||{};return{style: s=>{let l=r;for(let o of s)for(let a of o.set){let f=t[a.id];if(f){l=l?l+" "+f:f;break}}return l},scope:n}}function Wn(i, e){let t=null;for(let n of i){let r=n.style(e);r&&(t=t?t+" "+r:r)}return t}function Yt(i, e, t, n=0, r=i.length){let s=new ct(n,Array.isArray(e)?e:[e],t);s.highlightRange(i.cursor(),n,r,"",s.highlighters),s.flush(r)}var ct=class{constructor(e, t, n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e, t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e, t, n, r, s){let{type:l,from:o,to:a}=e;if(o>=n||a<=t)return;l.isTop&&(s=this.highlighters.filter(m=>!m.scope||m.scope(l)));let f=r,h=Hn(e)||pe.empty,u=Wn(s,h.tags);if(u&&(f&&(f+=" "),f+=u,h.mode==1&&(r+=(r?" ":"")+u)),this.startSpan(Math.max(t,o),f),h.opaque)return;let p=e.tree&&e.tree.prop(b.mounted);if(p&&p.overlay){let m=e.node.enter(p.overlay[0].from+o,1),w=this.highlighters.filter(D=>!D.scope||D.scope(p.tree.type)),v=e.firstChild();for(let D=0,M=o;; D++){let E=D<p.overlay.length?p.overlay[D]:null,C=E?E.from+o:a,j=Math.max(t,M),x=Math.min(n,C);if(j<x&&v)for(; e.from<x&&(this.highlightRange(e,j,x,r,s),this.startSpan(Math.min(x,e.to),f),!(e.to>=C||!e.nextSibling())););if(!E||C>n)break;M=E.to+o,M>t&&(this.highlightRange(m.cursor(),Math.max(t,E.from+o),Math.min(n,M),"",w),this.startSpan(Math.min(n,M),f))}v&&e.parent()}else if(e.firstChild()){p&&(r="");do if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,r,s),this.startSpan(Math.min(n,e.to),f)}while(e.nextSibling());e.parent()}}};function Hn(i){let e=i.type.prop(Xt);for(; e&&e.context&&!i.matchContext(e.context);)e=e.next;return e||null}var c=W.define,_e=c(),te=c(),Jt=c(te),Kt=c(te),ne=c(),Le=c(ne),ut=c(ne),K=c(),ae=c(K),G=c(),J=c(),dt=c(),ye=c(dt),Fe=c(),d={comment:_e,lineComment:c(_e),blockComment:c(_e),docComment:c(_e),name:te,variableName:c(te),typeName:Jt,tagName:c(Jt),propertyName:Kt,attributeName:c(Kt),className:c(te),labelName:c(te),namespace:c(te),macroName:c(te),literal:ne,string:Le,docString:c(Le),character:c(Le),attributeValue:c(Le),number:ut,integer:c(ut),float:c(ut),bool:c(ne),regexp:c(ne),escape:c(ne),color:c(ne),url:c(ne),keyword:G,self:c(G),null:c(G),atom:c(G),unit:c(G),modifier:c(G),operatorKeyword:c(G),controlKeyword:c(G),definitionKeyword:c(G),moduleKeyword:c(G),operator:J,derefOperator:c(J),arithmeticOperator:c(J),logicOperator:c(J),bitwiseOperator:c(J),compareOperator:c(J),updateOperator:c(J),definitionOperator:c(J),typeOperator:c(J),controlOperator:c(J),punctuation:dt,separator:c(dt),bracket:ye,angleBracket:c(ye),squareBracket:c(ye),paren:c(ye),brace:c(ye),content:K,heading:ae,heading1:c(ae),heading2:c(ae),heading3:c(ae),heading4:c(ae),heading5:c(ae),heading6:c(ae),contentSeparator:c(K),list:c(K),quote:c(K),emphasis:c(K),strong:c(K),link:c(K),monospace:c(K),strikethrough:c(K),inserted:c(),deleted:c(),changed:c(),invalid:c(),meta:Fe,documentMeta:c(Fe),annotation:c(Fe),processingInstruction:c(Fe),definition:W.defineModifier("definition"),constant:W.defineModifier("constant"),function:W.defineModifier("function"),standard:W.defineModifier("standard"),local:W.defineModifier("local"),special:W.defineModifier("special")};for(let i in d){let e=d[i];e instanceof W&&(e.name=i)}var Dr=pt([{tag:d.link,class:"tok-link"},{tag:d.heading,class:"tok-heading"},{tag:d.emphasis,class:"tok-emphasis"},{tag:d.strong,class:"tok-strong"},{tag:d.keyword,class:"tok-keyword"},{tag:d.atom,class:"tok-atom"},{tag:d.bool,class:"tok-bool"},{tag:d.url,class:"tok-url"},{tag:d.labelName,class:"tok-labelName"},{tag:d.inserted,class:"tok-inserted"},{tag:d.deleted,class:"tok-deleted"},{tag:d.literal,class:"tok-literal"},{tag:d.string,class:"tok-string"},{tag:d.number,class:"tok-number"},{tag:[d.regexp,d.escape,d.special(d.string)],class:"tok-string2"},{tag:d.variableName,class:"tok-variableName"},{tag:d.local(d.variableName),class:"tok-variableName tok-local"},{tag:d.definition(d.variableName),class:"tok-variableName tok-definition"},{tag:d.special(d.variableName),class:"tok-variableName2"},{tag:d.definition(d.propertyName),class:"tok-propertyName tok-definition"},{tag:d.typeName,class:"tok-typeName"},{tag:d.namespace,class:"tok-namespace"},{tag:d.className,class:"tok-className"},{tag:d.macroName,class:"tok-macroName"},{tag:d.propertyName,class:"tok-propertyName"},{tag:d.operator,class:"tok-operator"},{tag:d.comment,class:"tok-comment"},{tag:d.meta,class:"tok-meta"},{tag:d.invalid,class:"tok-invalid"},{tag:d.punctuation,class:"tok-punctuation"}]);var gt,fe=new b;function un(i){return $.define({combine:i? e=>e.concat(i):void 0})}var Vn=new b,H=(()=>{class i{constructor(t, n, r=[], s=""){this.data=t,this.name=s,ce.prototype.hasOwnProperty("tree")||Object.defineProperty(ce.prototype,"tree",{get(){return Q(this)}}),this.parser=n,this.extension=[re.of(this),ce.languageData.of((l, o, a)=>{let f=Zt(l,o,a),h=f.type.prop(fe);if(!h)return[];let u=l.facet(h),p=f.type.prop(Vn);if(p){let m=f.resolve(o-f.from,a);for(let w of p)if(w.test(m,l)){let v=l.facet(w.facet);return w.type=="replace"?v:v.concat(u)}}return u})].concat(r)}isActiveAt(t, n, r=-1){return Zt(t,n,r).type.prop(fe)==this.data}findRegions(t){let n=t.facet(re);if(n?.data==this.data)return[{from:0,to:t.doc.length}];if(!n||!n.allowsNesting)return[];let r=[],s=(l, o)=>{if(l.prop(fe)==this.data){r.push({from:o,to:o+l.length});return}let a=l.prop(b.mounted);if(a){if(a.tree.prop(fe)==this.data){if(a.overlay)for(let f of a.overlay)r.push({from:f.from+o,to:f.to+o});else r.push({from:o,to:o+l.length});return}else if(a.overlay){let f=r.length;if(s(a.tree,a.overlay[0].from+o),r.length>f)return}}for(let f=0; f<l.children.length; f++){let h=l.children[f];h instanceof A&&s(h,l.positions[f]+o)}};return s(Q(t),0),r}get allowsNesting(){return!0}}return i.setState=me.define(),i})();function Zt(i, e, t){let n=i.facet(re),r=Q(i).topNode;if(!n||n.allowsNesting)for(let s=r; s; s=s.enter(e,t,I.ExcludeBuffers))s.type.isTop&&(r=s);return r}var en=class i extends H{constructor(e, t, n){super(e,t,[],n),this.parser=t}static define(e){let t=un(e.languageData);return new i(t,e.parser.configure({props:[fe.add(n=>n.isTop?t:void 0)]}),e.name)}configure(e, t){return new i(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}};function Q(i){let e=i.field(H.state,!1);return e?e.tree:A.empty}var yt=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e, t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}},xe=null,ve=class i{constructor(e, t, n=[], r, s, l, o, a){this.parser=e,this.state=t,this.fragments=n,this.tree=r,this.treeLen=s,this.viewport=l,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e, t, n){return new i(e,t,[],A.empty,0,n,[],null)}startParse(){return this.parser.startParse(new yt(this.state.doc),this.fragments)}work(e, t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=A.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let r=Date.now()+e;e=()=>Date.now()>r}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let r=this.parse.advance();if(r)if(this.fragments=this.withoutTempSkipped(Y.addTree(r,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=r,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(; !(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Y.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=xe;xe=this;try{return e()}finally{xe=t}}withoutTempSkipped(e){for(let t; t=this.tempSkipped.pop();)e=tn(e,t.from,t.to);return e}changes(e, t){let{fragments:n,tree:r,treeLen:s,viewport:l,skipped:o}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((f, h, u, p)=>a.push({fromA:f,toA:h,fromB:u,toB:p})),n=Y.applyChanges(n,a),r=A.empty,s=0,l={from:e.mapPos(l.from,-1),to:e.mapPos(l.to,1)},this.skipped.length){o=[];for(let f of this.skipped){let h=e.mapPos(f.from,1),u=e.mapPos(f.to,-1);h<u&&o.push({from:h,to:u})}}}return new i(this.parser,t,n,r,s,l,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let n=0; n<this.skipped.length; n++){let{from:r,to:s}=this.skipped[n];r<e.to&&s>e.from&&(this.fragments=tn(this.fragments,r,s),this.skipped.splice(n--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e, t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends be{createParse(t, n, r){let s=r[0].from,l=r[r.length-1].to;return{parsedPos:s,advance(){let a=xe;if(a){for(let f of r)a.tempSkipped.push(f);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=l,new A(_.none,[],[],l-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return xe}};function tn(i, e, t){return Y.applyChanges(i,[{fromA:e,toA:t,fromB:e,toB:t}])}var Se=class i{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new i(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=ve.create(e.facet(re).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new i(n)}};H.state=Ne.define({create:Se.init,update(i, e){for(let t of e.effects)if(t.is(H.setState))return t.value;return e.startState.facet(re)!=e.state.facet(re)?Se.init(e.state):i.apply(e)}});var cn= i=>{let e=setTimeout(()=>i(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(cn= i=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(i,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});var mt=typeof navigator<"u"&&(!((gt=navigator.scheduling)===null||gt===void 0)&&gt.isInputPending)?()=>navigator.scheduling.isInputPending():null,$n=Ie.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(H.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(H.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=cn(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:r}}=this.view,s=n.field(H.state);if(s.tree==s.context.tree&&s.context.isDone(r+1e5))return;let l=Date.now()+Math.min(this.chunkBudget,100,e&&!mt?Math.max(25,e.timeRemaining()-5):1e9),o=s.context.treeLen<r&&n.doc.length>r+1e3,a=s.context.work(()=>mt&&mt()||Date.now()>l,r+(o?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:H.setState.of(new Se(s.context))})),this.chunkBudget>0&&!(a&&!o)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Rt(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),re=$.define({combine(i){return i.length?i[0]:null},enables: i=>[H.state,$n,q.contentAttributes.compute([i], e=>{let t=e.facet(i);return t&&t.name?{"data-language":t.name}:{}})]}),nn=class{constructor(e, t=[]){this.language=e,this.support=t,this.extension=[e,t]}},rn=class i{constructor(e, t, n, r, s, l=void 0){this.name=e,this.alias=t,this.extensions=n,this.filename=r,this.loadFunc=s,this.support=l,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e, e=>{throw this.loading=null,e}))}static of(e){let{load:t,support:n}=e;if(!t){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(n)}return new i(e.name,(e.alias||[]).concat(e.name).map(r=>r.toLowerCase()),e.extensions||[],e.filename,t,n)}static matchFilename(e, t){for(let r of e)if(r.filename&&r.filename.test(t))return r;let n=/\.([^.]+)$/.exec(t);if(n){for(let r of e)if(r.extensions.indexOf(n[1])>-1)return r}return null}static matchLanguageName(e, t, n=!0){t=t.toLowerCase();for(let r of e)if(r.alias.some(s=>s==t))return r;if(n)for(let r of e)for(let s of r.alias){let l=t.indexOf(s);if(l>-1&&(s.length>2||!/\w/.test(t[l-1])&&!/\w/.test(t[l+s.length])))return r}return null}},qn=$.define(),dn=$.define({combine: i=>{if(!i.length)return"  ";let e=i[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(i[0]));return e}});function Ue(i){let e=i.facet(dn);return e.charCodeAt(0)==9?i.tabSize*e.length:e.length}function Gn(i, e){let t="",n=i.tabSize,r=i.facet(dn)[0];if(r=="	"){for(; e>=n;)t+="	",e-=n;r=" "}for(let s=0; s<e; s++)t+=r;return t}function Jn(i, e){i instanceof ce&&(i=new We(i));for(let n of i.state.facet(qn)){let r=n(i,e);if(r!==void 0)return r}let t=Q(i.state);return t.length>=e?Kn(i,t,e):null}var We=class{constructor(e, t={}){this.state=e,this.options=t,this.unit=Ue(e)}lineAt(e, t=1){let n=this.state.doc.lineAt(e),{simulateBreak:r,simulateDoubleBreak:s}=this.options;return r!=null&&r>=n.from&&r<=n.to?s&&r==e?{text:"",from:e}:(t<0?r<e:r<=e)?{text:n.text.slice(r-n.from),from:r}:{text:n.text.slice(0,r-n.from),from:n.from}:n}textAfterPos(e, t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:r}=this.lineAt(e,t);return n.slice(e-r,Math.min(n.length,e+100-r))}column(e, t=1){let{text:n,from:r}=this.lineAt(e,t),s=this.countColumn(n,e-r),l=this.options.overrideIndentation?this.options.overrideIndentation(r):-1;return l>-1&&(s+=l-this.countColumn(n,n.search(/\S|$/))),s}countColumn(e, t=e.length){return Et(e,this.state.tabSize,t)}lineIndent(e, t=1){let{text:n,from:r}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let l=s(r);if(l>-1)return l}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}},pn=new b;function Kn(i, e, t){let n=e.resolveStack(t),r=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(r!=n.node){let s=[];for(let l=r; l&&!(l.from==n.node.from&&l.type==n.node.type); l=l.parent)s.push(l);for(let l=s.length-1; l>=0; l--)n={node:s[l],next:n}}return gn(n,i,t)}function gn(i, e, t){for(let n=i; n; n=n.next){let r=Xn(n.node);if(r)return r(xt.create(e,t,n))}return 0}function Qn(i){return i.pos==i.options.simulateBreak&&i.options.simulateDoubleBreak}function Xn(i){let e=i.type.prop(pn);if(e)return e;let t=i.firstChild,n;if(t&&(n=t.type.prop(b.closedBy))){let r=i.lastChild,s=r&&n.indexOf(r.name)>-1;return l=>mn(l,!0,1,void 0,s&&!Qn(l)?r.from:void 0)}return i.parent==null?Yn:null}function Yn(){return 0}var xt=class i extends We{constructor(e, t, n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e, t, n){return new i(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(; n.parent&&n.parent.from==n.from;)n=n.parent;if(Zn(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return gn(this.context.next,this.base,this.pos)}};function Zn(i, e){for(let t=e; t; t=t.parent)if(i==t)return!0;return!1}function er(i){let e=i.node,t=e.childAfter(e.from),n=e.lastChild;if(!t)return null;let r=i.options.simulateBreak,s=i.state.doc.lineAt(t.from),l=r==null||r<=s.from?s.to:Math.min(s.to,r);for(let o=t.to;;){let a=e.childAfter(o);if(!a||a==n)return null;if(!a.type.isSkipped){if(a.from>=l)return null;let f=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+f}}o=a.to}}function Ur({closing:i,align:e=!0,units:t=1}){return n=>mn(n,e,t,i)}function mn(i, e, t, n, r){let s=i.textAfter,l=s.match(/^\s*/)[0].length,o=n&&s.slice(l,l+n.length)==n||r==i.pos+l,a=e?er(i):null;return a?o?i.column(a.from):i.column(a.to):i.baseIndent+(o?0:i.unit*t)}var Wr= i=>i.baseIndent;function Hr({except:i,units:e=1}={}){return t=>{let n=i&&i.test(t.textAfter);return t.baseIndent+(n?0:e*t.unit)}}var tr=200;function Vr(){return ce.transactionFilter.of(i=>{if(!i.docChanged||!i.isUserEvent("input.type")&&!i.isUserEvent("input.complete"))return i;let e=i.startState.languageDataAt("indentOnInput",i.startState.selection.main.head);if(!e.length)return i;let t=i.newDoc,{head:n}=i.newSelection.main,r=t.lineAt(n);if(n>r.from+tr)return i;let s=t.sliceString(r.from,n);if(!e.some(f=>f.test(s)))return i;let{state:l}=i,o=-1,a=[];for(let{head:f}of l.selection.ranges){let h=l.doc.lineAt(f);if(h.from==o)continue;o=h.from;let u=Jn(l,h.from);if(u==null)continue;let p=/^\s*/.exec(h.text)[0],m=Gn(l,u);p!=m&&a.push({from:h.from,to:h.from+p.length,insert:m})}return a.length?[i,{changes:a,sequential:!0}]:i})}var nr=$.define(),rr=new b;function $r(i){let e=i.firstChild,t=i.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?i.to:t.from}:null}function ir(i, e, t){let n=Q(i);if(n.length<t)return null;let r=n.resolveStack(t,1),s=null;for(let l=r; l; l=l.next){let o=l.node;if(o.to<=t||o.from>t)continue;if(s&&o.from<e)break;let a=o.type.prop(rr);if(a&&(o.to<n.length-50||n.length==i.doc.length||!sr(o))){let f=a(o,i);f&&f.from<=t&&f.from>=e&&f.to>t&&(s=f)}}return s}function sr(i){let e=i.lastChild;return e&&e.to==i.to&&e.type.isError}function He(i, e, t){for(let n of i.facet(nr)){let r=n(i,e,t);if(r)return r}return ir(i,e,t)}function kn(i, e){let t=e.mapPos(i.from,1),n=e.mapPos(i.to,-1);return t>=n?void 0:{from:t,to:n}}var Je=me.define({map:kn}),Ce=me.define({map:kn});function bn(i){let e=[];for(let{head:t}of i.state.selection.ranges)e.some(n=>n.from<=t&&n.to>=t)||e.push(i.lineBlockAt(t));return e}var he=Ne.define({create(){return L.none},update(i, e){i=i.map(e.changes);for(let t of e.effects)if(t.is(Je)&&!lr(i,t.value.from,t.value.to)){let{preparePlaceholder:n}=e.state.facet(Tt),r=n?L.replace({widget:new wt(n(e.state,t.value))}):sn;i=i.update({add:[r.range(t.value.from,t.value.to)]})}else t.is(Ce)&&(i=i.update({filter:(n, r)=>t.value.from!=n||t.value.to!=r,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:n}=e.selection.main;i.between(n,n,(r, s)=>{r<n&&s>n&&(t=!0)}),t&&(i=i.update({filterFrom:n,filterTo:n,filter:(r, s)=>s<=n||r>=n}))}return i},provide: i=>q.decorations.from(i),toJSON(i, e){let t=[];return i.between(0,e.doc.length,(n, r)=>{t.push(n,r)}),t},fromJSON(i){if(!Array.isArray(i)||i.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0; t<i.length;){let n=i[t++],r=i[t++];if(typeof n!="number"||typeof r!="number")throw new RangeError("Invalid JSON for fold state");e.push(sn.range(n,r))}return L.set(e,!0)}});function Ve(i, e, t){var n;let r=null;return(n=i.field(he,!1))===null||n===void 0||n.between(e,t,(s, l)=>{(!r||r.from>s)&&(r={from:s,to:l})}),r}function lr(i, e, t){let n=!1;return i.between(e,e,(r, s)=>{r==e&&s==t&&(n=!0)}),n}function yn(i, e){return i.field(he,!1)?e:e.concat(me.appendConfig.of(wn()))}var or= i=>{for(let e of bn(i)){let t=He(i.state,e.from,e.to);if(t)return i.dispatch({effects:yn(i.state,[Je.of(t),xn(i,t)])}),!0}return!1},ar= i=>{if(!i.state.field(he,!1))return!1;let e=[];for(let t of bn(i)){let n=Ve(i.state,t.from,t.to);n&&e.push(Ce.of(n),xn(i,n,!1))}return e.length&&i.dispatch({effects:e}),e.length>0};function xn(i, e, t=!0){let n=i.state.doc.lineAt(e.from).number,r=i.state.doc.lineAt(e.to).number;return q.announce.of(`${i.state.phrase(t?"Folded lines":"Unfolded lines")} ${n} ${i.state.phrase("to")} ${r}.`)}var fr= i=>{let{state:e}=i,t=[];for(let n=0; n<e.doc.length;){let r=i.lineBlockAt(n),s=He(e,r.from,r.to);s&&t.push(Je.of(s)),n=(s?i.lineBlockAt(s.to):r).to+1}return t.length&&i.dispatch({effects:yn(i.state,t)}),!!t.length},hr= i=>{let e=i.state.field(he,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,i.state.doc.length,(n, r)=>{t.push(Ce.of({from:n,to:r}))}),i.dispatch({effects:t}),!0};var qr=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:or},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:ar},{key:"Ctrl-Alt-[",run:fr},{key:"Ctrl-Alt-]",run:hr}],ur={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},Tt=$.define({combine(i){return Ke(i,ur)}});function wn(i){let e=[he,dr];return i&&e.push(Tt.of(i)),e}function vn(i, e){let{state:t}=i,n=t.facet(Tt),r= l=>{let o=i.lineBlockAt(i.posAtDOM(l.target)),a=Ve(i.state,o.from,o.to);a&&i.dispatch({effects:Ce.of(a)}),l.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(i,r,e);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}var sn=L.replace({widget:new class extends Ye{toDOM(i){return vn(i,null)}}}),wt=class extends Ye{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return vn(e,this.value)}},cr={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1},we=class extends _t{constructor(e, t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}};function Gr(i={}){let e=Object.assign(Object.assign({},cr),i),t=new we(e,!0),n=new we(e,!1),r=Ie.fromClass(class{constructor(l){this.from=l.viewport.from,this.markers=this.buildMarkers(l)}update(l){(l.docChanged||l.viewportChanged||l.startState.facet(re)!=l.state.facet(re)||l.startState.field(he,!1)!=l.state.field(he,!1)||Q(l.startState)!=Q(l.state)||e.foldingChanged(l))&&(this.markers=this.buildMarkers(l.view))}buildMarkers(l){let o=new Qe;for(let a of l.viewportLineBlocks){let f=Ve(l.state,a.from,a.to)?n:He(l.state,a.from,a.to)?t:null;f&&o.add(a.from,a.from,f)}return o.finish()}}),{domEventHandlers:s}=e;return[r,Lt({class:"cm-foldGutter",markers(l){var o;return((o=l.plugin(r))===null||o===void 0?void 0:o.markers)||Dt.empty},initialSpacer(){return new we(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(l, o, a)=>{if(s.click&&s.click(l,o,a))return!0;let f=Ve(l.state,o.from,o.to);if(f)return l.dispatch({effects:Ce.of(f)}),!0;let h=He(l.state,o.from,o.to);return h?(l.dispatch({effects:Je.of(h)}),!0):!1}})}),wn()]}var dr=q.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}}),$e=class i{constructor(e, t){this.specs=e;let n;function r(o){let a=Xe.newName();return(n||(n=Object.create(null)))["."+a]=o,a}let s=typeof t.all=="string"?t.all:t.all?r(t.all):void 0,l=t.scope;this.scope=l instanceof H? o=>o.prop(fe)==l.data:l? o=>o==l:void 0,this.style=pt(e.map(o=>({tag:o.tag,class:o.class||r(Object.assign({},o,{tag:null}))})),{all:s}).style,this.module=n?new Xe(n):null,this.themeType=t.themeType}static define(e, t){return new i(e,t||{})}},vt=$.define(),Sn=$.define({combine(i){return i.length?[i[0]]:null}});function kt(i){let e=i.facet(vt);return e.length?e:i.facet(Sn)}function Jr(i, e){let t=[pr],n;return i instanceof $e&&(i.module&&t.push(q.styleModule.of(i.module)),n=i.themeType),e?.fallback?t.push(Sn.of(i)):n?t.push(vt.computeN([q.darkTheme], r=>r.facet(q.darkTheme)==(n=="dark")?[i]:[])):t.push(vt.of(i)),t}var St=class{constructor(e){this.markCache=Object.create(null),this.tree=Q(e.state),this.decorations=this.buildDeco(e,kt(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=Q(e.state),n=kt(e.state),r=n!=kt(e.startState),{viewport:s}=e.view,l=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!r&&t.type==this.tree.type&&l>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=l):(t!=this.tree||e.viewportChanged||r)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=s.to)}buildDeco(e, t){if(!t||!this.tree.length)return L.none;let n=new Qe;for(let{from:r,to:s}of e.visibleRanges)Yt(this.tree,t,(l, o, a)=>{n.add(l,o,this.markCache[a]||(this.markCache[a]=L.mark({class:a})))},r,s);return n.finish()}},pr=Mt.high(Ie.fromClass(St,{decorations: i=>i.decorations})),Kr=$e.define([{tag:d.meta,color:"#404740"},{tag:d.link,textDecoration:"underline"},{tag:d.heading,textDecoration:"underline",fontWeight:"bold"},{tag:d.emphasis,fontStyle:"italic"},{tag:d.strong,fontWeight:"bold"},{tag:d.strikethrough,textDecoration:"line-through"},{tag:d.keyword,color:"#708"},{tag:[d.atom,d.bool,d.url,d.contentSeparator,d.labelName],color:"#219"},{tag:[d.literal,d.inserted],color:"#164"},{tag:[d.string,d.deleted],color:"#a11"},{tag:[d.regexp,d.escape,d.special(d.string)],color:"#e40"},{tag:d.definition(d.variableName),color:"#00f"},{tag:d.local(d.variableName),color:"#30a"},{tag:[d.typeName,d.namespace],color:"#085"},{tag:d.className,color:"#167"},{tag:[d.special(d.variableName),d.macroName],color:"#256"},{tag:d.definition(d.propertyName),color:"#00c"},{tag:d.comment,color:"#940"},{tag:d.invalid,color:"#f00"}]),gr=q.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),An=1e4,Cn="()[]{}",Pn=$.define({combine(i){return Ke(i,{afterCursor:!0,brackets:Cn,maxScanDistance:An,renderMatch:br})}}),mr=L.mark({class:"cm-matchingBracket"}),kr=L.mark({class:"cm-nonmatchingBracket"});function br(i){let e=[],t=i.matched?mr:kr;return e.push(t.range(i.start.from,i.start.to)),i.end&&e.push(t.range(i.end.from,i.end.to)),e}var yr=Ne.define({create(){return L.none},update(i, e){if(!e.docChanged&&!e.selection)return i;let t=[],n=e.state.facet(Pn);for(let r of e.state.selection.ranges){if(!r.empty)continue;let s=je(e.state,r.head,-1,n)||r.head>0&&je(e.state,r.head-1,1,n)||n.afterCursor&&(je(e.state,r.head,1,n)||r.head<e.state.doc.length&&je(e.state,r.head+1,-1,n));s&&(t=t.concat(n.renderMatch(s,e.state)))}return L.set(t,!0)},provide: i=>q.decorations.from(i)}),xr=[yr,gr];function Qr(i={}){return[Pn.of(i),xr]}var wr=new b;function At(i, e, t){let n=i.prop(e<0?b.openedBy:b.closedBy);if(n)return n;if(i.name.length==1){let r=t.indexOf(i.name);if(r>-1&&r%2==(e<0?1:0))return[t[r+e]]}return null}function Ct(i){let e=i.type.prop(wr);return e?e(i.node):i}function je(i, e, t, n={}){let r=n.maxScanDistance||An,s=n.brackets||Cn,l=Q(i),o=l.resolveInner(e,t);for(let a=o; a; a=a.parent){let f=At(a.type,t,s);if(f&&a.from<a.to){let h=Ct(a);if(h&&(t>0?e>=h.from&&e<h.to:e>h.from&&e<=h.to))return vr(i,e,t,a,h,f,s)}}return Sr(i,e,t,l,o.type,r,s)}function vr(i, e, t, n, r, s, l){let o=n.parent,a={from:r.from,to:r.to},f=0,h=o?.cursor();if(h&&(t<0?h.childBefore(n.from):h.childAfter(n.to)))do if(t<0?h.to<=n.from:h.from>=n.to){if(f==0&&s.indexOf(h.type.name)>-1&&h.from<h.to){let u=Ct(h);return{start:a,end:u?{from:u.from,to:u.to}:void 0,matched:!0}}else if(At(h.type,t,l))f++;else if(At(h.type,-t,l)){if(f==0){let u=Ct(h);return{start:a,end:u&&u.from<u.to?{from:u.from,to:u.to}:void 0,matched:!1}}f--}}while(t<0?h.prevSibling():h.nextSibling());return{start:a,matched:!1}}function Sr(i, e, t, n, r, s, l){let o=t<0?i.sliceDoc(e-1,e):i.sliceDoc(e,e+1),a=l.indexOf(o);if(a<0||a%2==0!=t>0)return null;let f={from:t<0?e-1:e,to:t>0?e+1:e},h=i.doc.iterRange(e,t>0?i.doc.length:0),u=0;for(let p=0; !h.next().done&&p<=s;){let m=h.value;t<0&&(p+=m.length);let w=e+p*t;for(let v=t>0?0:m.length-1,D=t>0?m.length:-1; v!=D; v+=t){let M=l.indexOf(m[v]);if(!(M<0||n.resolveInner(w+v,1).type!=r))if(M%2==0==t>0)u++;else{if(u==1)return{start:f,end:{from:w+v,to:w+v+1},matched:M>>1==a>>1};u--}}t>0&&(p+=m.length)}return h.done?{start:f,matched:!1}:null}function ln(i, e, t, n=0, r=0){e==null&&(e=i.search(/[^\s\u00a0]/),e==-1&&(e=i.length));let s=r;for(let l=n; l<e; l++)i.charCodeAt(l)==9?s+=t-s%t:s++;return s}var qe=class{constructor(e, t, n, r){this.string=e,this.tabSize=t,this.indentUnit=n,this.overrideIndent=r,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),n;if(typeof e=="string"?n=t==e:n=t&&(e instanceof RegExp?e.test(t):e(t)),n)return++this.pos,t}eatWhile(e){let t=this.pos;for(; this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(; /[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ln(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:ln(this.string,null,this.tabSize)}match(e, t, n){if(typeof e=="string"){let r= l=>n?l.toLowerCase():l,s=this.string.substr(this.pos,e.length);return r(s)==r(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}};function Ar(i){return{name:i.name||"",token:i.token,blankLine:i.blankLine||(()=>{}),startState:i.startState||(()=>!0),copyState:i.copyState||Cr,indent:i.indent||(()=>null),languageData:i.languageData||{},tokenTable:i.tokenTable||It}}function Cr(i){if(typeof i!="object")return i;let e={};for(let t in i){let n=i[t];e[t]=n instanceof Array?n.slice():n}return e}var on=new WeakMap,an=class i extends H{constructor(e){let t=un(e.languageData),n=Ar(e),r,s=new class extends be{createParse(l, o, a){return new Pt(r,l,o,a)}};super(t,s,[],e.name),this.topNode=Ir(t,this),r=this,this.streamParser=n,this.stateAfter=new b({perNode:!0}),this.tokenTable=e.tokenTable?new Ge(n.tokenTable):Nr}static define(e){return new i(e)}getIndent(e){let t,{overrideIndentation:n}=e.options;n&&(t=on.get(e.state),t!=null&&t<e.pos-1e4&&(t=void 0));let r=Nt(this,e.node.tree,e.node.from,e.node.from,t??e.pos),s,l;if(r?(l=r.state,s=r.pos+1):(l=this.streamParser.startState(e.unit),s=e.node.from),e.pos-s>1e4)return null;for(; s<e.pos;){let a=e.state.doc.lineAt(s),f=Math.min(e.pos,a.to);if(a.length){let h=n?n(a.from):-1,u=new qe(a.text,e.state.tabSize,e.unit,h<0?void 0:h);for(; u.pos<f-a.from;)Nn(this.streamParser.token,u,l)}else this.streamParser.blankLine(l,e.unit);if(f==e.pos)break;s=a.to+1}let o=e.lineAt(e.pos);return n&&t==null&&on.set(e.state,o.from),this.streamParser.indent(l,/^\s*(.*)/.exec(o.text)[1],e)}get allowsNesting(){return!1}};function Nt(i, e, t, n, r){let s=t>=n&&t+e.length<=r&&e.prop(i.stateAfter);if(s)return{state:i.streamParser.copyState(s),pos:t+e.length};for(let l=e.children.length-1; l>=0; l--){let o=e.children[l],a=t+e.positions[l],f=o instanceof A&&a<r&&Nt(i,o,a,n,r);if(f)return f}return null}function Tn(i, e, t, n, r){if(r&&t<=0&&n>=e.length)return e;!r&&t==0&&e.type==i.topNode&&(r=!0);for(let s=e.children.length-1; s>=0; s--){let l=e.positions[s],o=e.children[s],a;if(l<n&&o instanceof A){if(!(a=Tn(i,o,t-l,n-l,r)))break;return r?new A(e.type,e.children.slice(0,s).concat(a),e.positions.slice(0,s+1),l+a.length):a}}return null}function Pr(i, e, t, n, r){for(let s of e){let l=s.from+(s.openStart?25:0),o=s.to-(s.openEnd?25:0),a=l<=t&&o>t&&Nt(i,s.tree,0-s.offset,t,o),f;if(a&&a.pos<=n&&(f=Tn(i,s.tree,t+s.offset,a.pos+s.offset,!1)))return{state:a.state,tree:f}}return{state:i.streamParser.startState(r?Ue(r):4),tree:A.empty}}var Pt=class{constructor(e, t, n, r){this.lang=e,this.input=t,this.fragments=n,this.ranges=r,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=r[r.length-1].to;let s=ve.get(),l=r[0].from,{state:o,tree:a}=Pr(e,n,l,this.to,s?.state);this.state=o,this.parsedPos=this.chunkStart=l+a.length;for(let f=0; f<a.children.length; f++)this.chunks.push(a.children[f]),this.chunkPos.push(a.positions[f]);s&&this.parsedPos<s.viewport.from-1e5&&r.some(f=>f.from<=s.viewport.from&&f.to>=s.viewport.from)&&(this.state=this.lang.streamParser.startState(Ue(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=ve.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),n=Math.min(t,this.chunkStart+2048);for(e&&(n=Math.min(n,e.viewport.to)); this.parsedPos<n;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let n=t.indexOf(`
`);n>-1&&(t=t.slice(0,n))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),n=e+t.length;for(let r=this.rangeIndex;;){let s=this.ranges[r].to;if(s>=n||(t=t.slice(0,s-(n-t.length)),r++,r==this.ranges.length))break;let l=this.ranges[r].from,o=this.lineAfter(l);t+=o,n=l+o.length}return{line:t,end:n}}skipGapsTo(e,t,n){for(;;){let r=this.ranges[this.rangeIndex].to,s=e+t;if(n>0?r>s:r>=s)break;let l=this.ranges[++this.rangeIndex].from;t+=l-r}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,n,r){let s=4;if(this.ranges.length>1){r=this.skipGapsTo(t,r,1),t+=r;let o=this.chunk.length;r=this.skipGapsTo(n,r,-1),n+=r,s+=this.chunk.length-o}let l=this.chunk.length-4;return s==4&&l>=0&&this.chunk[l]==e&&this.chunk[l+2]==t?this.chunk[l+2]=n:this.chunk.push(e,t,n,s),r}parseLine(e){let{line:t,end:n}=this.nextLine(),r=0,{streamParser:s}=this.lang,l=new qe(t,e?e.state.tabSize:4,e?Ue(e.state):2);if(l.eol())s.blankLine(this.state,l.indentUnit);else for(;!l.eol();){let o=Nn(s.token,l,this.state);if(o&&(r=this.emitToken(this.lang.tokenTable.resolve(o),this.parsedPos+l.start,this.parsedPos+l.pos,r)),l.start>1e4)break}this.parsedPos=n,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=A.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Tr,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new A(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new A(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}};function Nn(i,e,t){e.start=e.pos;for(let n=0;n<10;n++){let r=i(e,t);if(e.pos>e.start)return r}throw new Error("Stream parser failed to advance stream.")}var It=Object.create(null),Ae=[_.none],Tr=new Me(Ae),fn=[],hn=Object.create(null),In=Object.create(null);for(let[i,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])In[i]=Bn(It,e);var Ge=class{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),In)}resolve(e){return e?this.table[e]||(this.table[e]=Bn(this.extra,e)):0}},Nr=new Ge(It);function bt(i,e){fn.indexOf(i)>-1||(fn.push(i),console.warn(e))}function Bn(i,e){let t=[];for(let o of e.split(" ")){let a=[];for(let f of o.split(".")){let h=i[f]||d[f];h?typeof h=="function"?a.length?a=a.map(h):bt(f,`Modifier ${f} used at start of tag`):a.length?bt(f,`Tag ${f} used as modifier`):a=Array.isArray(h)?h:[h]:bt(f,`Unknown highlighting tag ${f}`)}for(let f of a)t.push(f)}if(!t.length)return 0;let n=e.replace(/ /g,"_"),r=n+" "+t.map(o=>o.id),s=hn[r];if(s)return s.id;let l=hn[r]=_.define({id:Ae.length,name:n,props:[Qt({[n]:t})]});return Ae.push(l),l.id}function Ir(i,e){let t=_.define({id:Ae.length,name:"Document",props:[fe.add(()=>i),pn.add(()=>n=>e.getIndent(n))],top:!0});return Ae.push(t),t}var Xr={rtl:L.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:Ze.RTL}),ltr:L.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:Ze.LTR}),auto:L.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};export{b as a,_ as b,Me as c,I as d,A as e,Ut as f,be as g,Br as h,W as i,Qt as j,d as k,fe as l,un as m,Vn as n,H as o,en as p,Q as q,ve as r,nn as s,rn as t,dn as u,Ue as v,Gn as w,Jn as x,We as y,pn as z,Ur as A,Wr as B,Hr as C,Vr as D,nr as E,rr as F,$r as G,qr as H,Gr as I,$e as J,Jr as K,Kr as L,Qr as M,wr as N,je as O,an as P};
